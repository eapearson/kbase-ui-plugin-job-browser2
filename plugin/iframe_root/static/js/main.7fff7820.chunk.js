(window["webpackJsonpreact-app"]=window["webpackJsonpreact-app"]||[]).push([[0],{1082:function(e,t,n){},1083:function(e,t,n){"use strict";var r=n(92),a=n(45),i=n(55),o=n(53),s=n(56),u=n(44),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=c(n(1084)),h=function e(t){var n=t.name,r=t.onSuccess,a=t.onError;u(this,e),this.name=n,this.onSuccess=r,this.onError=a},d=function(e){function t(e){var n;return u(this,t),(n=i(this,o(t).call(this,e))).started=new Date,n.timeout=e.timeout||5e3,n}return s(t,e),t}(h),p=function(){function e(t){var n=t.from,r=t.to;u(this,e),this.from=n,this.to=r,this.id=l.default.v4(),this.created=new Date}return a(e,[{key:"toJSON",value:function(){return{from:this.from,to:this.to,id:this.id,created:this.created}}}]),e}(),f=function(){function e(t){var n=t.name,r=t.payload,a=t.from,i=t.to;u(this,e),this.name=n,this.payload=r,this.id=l.default.v4(),this.created=new Date,this.envelope=new p({from:a,to:i})}return a(e,[{key:"toJSON",value:function(){return{envelope:this.envelope.toJSON(),name:this.name,payload:this.payload}}}]),e}(),m=function(){function e(t){if(u(this,e),this.window=t.window||window,this.debug=t.debug||!1,null===this.window.document)throw new Error("No document");if(null===this.window.document.location)throw new Error("No location");this.host=t.host||this.window.document.location.origin,this.id=t.id||l.default.v4(),this.debugLog("Setting partner id to "+t.to),this.partnerId=t.to||null,this.awaitingResponse=new Map,this.waitingListeners=new Map,this.listeners=new Map,this.lastId=0,this.sentCount=0,this.receivedCount=0,this.unwelcomeReceivedCount=0,this.unwelcomeReceivedCountThreshhold=100,this.unwelcomeReceiptWarning=!1,this.unwelcomeReceiptWarningCount=0,this.currentListener=null}return a(e,[{key:"debugLog",value:function(e){this.debug&&console.log("[windowChannel]["+this.id+"] "+e)}},{key:"setTo",value:function(e){this.partnerId=e}},{key:"genId",value:function(){return this.lastId+=1,"msg_"+String(this.lastId)}},{key:"receiveMessage",value:function(e){var t=e.data;if(!t)return this.unwelcomeReceivedCount++,void(this.unwelcomeReceiptWarning&&console.warn("TS No message data; message ignored",e));if(!t.envelope)return this.unwelcomeReceivedCount++,void(this.unwelcomeReceiptWarning&&console.warn("No message envelope, not from KBase; message ignored",e));if(this.debug&&console.debug("[windowChannel][debug]",this.id,t.envelope.to,this.partnerId,t.envelope.from,t),t.envelope.to!==this.id)return this.unwelcomeReceivedCount++,void(this.unwelcomeReceiptWarning&&console.warn("Message envelope does not match this channel's id","message",t,"channel id",this.id,"partner id",this.partnerId));if(this.unwelcomeReceiptWarningCount>this.unwelcomeReceivedCountThreshhold&&(this.unwelcomeReceiptWarning=!1,console.warn("Unwelcome message warning disabled after "+this.unwelcomeReceiptWarningCount+" instances.")),t.envelope.id&&this.awaitingResponse.has(t.envelope.id))try{var n=this.awaitingResponse.get(t.envelope.id);this.awaitingResponse.delete(t.envelope.id),n&&n.handler(t.payload)}catch(a){console.error("Error handling response for message ",t,a)}if(this.waitingListeners.has(t.name)){var r=this.waitingListeners.get(t.name);this.waitingListeners.delete(t.name),r.forEach((function(e){try{e.onSuccess(t.payload)}catch(a){e.onError?e.onError(a):console.error("Error handling listener for message",t,a)}}))}this.listeners.has(t.name)&&this.listeners.get(t.name).forEach((function(e){e.onSuccess||console.warn("no handler for listener!",e);try{e.onSuccess(t.payload)}catch(a){e.onError?e.onError(a):console.error("Error handling listener for message",t,a)}}))}},{key:"listen",value:function(e){this.listeners.has(e.name)||this.listeners.set(e.name,[]),this.listeners.get(e.name).push(e)}},{key:"on",value:function(e,t,n){this.listen(new h({name:e,onSuccess:t,onError:n}))}},{key:"sendMessage",value:function(e){this.window.postMessage(e.toJSON(),this.host)}},{key:"send",value:function(e,t){if(this.debugLog(" sending message: "+e+", with payload: "+JSON.stringify(t)),null===this.partnerId)throw new Error("Channel partner id not set, cannot send message");var n=new f({name:e,payload:t,from:this.id,to:this.partnerId});this.sendMessage(n)}},{key:"sendRequest",value:function(e,t){this.awaitingResponse.set("message.id",{started:new Date,handler:t}),this.sendMessage(e)}},{key:"request",value:function(e,t){var n=this;return new Promise((function(r,a){try{if(null===n.partnerId)throw new Error("Channel partner id not set, cannot issue request");n.sendRequest(new f({name:e,payload:t,from:n.id,to:n.partnerId}),(function(e){r(e)}))}catch(i){a(i)}}))}},{key:"startMonitor",value:function(){var e=this;window.setTimeout((function(){for(var t=(new Date).getTime(),n=function(){var n=i[a],s=(o=r(n,2))[0];0===o[1].filter((function(e){if(e instanceof d){var n=t-e.started.getTime();if(n>e.timeout){try{e.onError&&e.onError(new Error("timout after "+n))}catch(r){console.error("Error calling error handler",s,r)}return!1}return!0}return!0})).length&&e.waitingListeners.delete(s)},a=0,i=Array.from(e.waitingListeners.entries());a<i.length;a++){var o;n()}e.waitingListeners.size>0&&e.startMonitor()}),100)}},{key:"listenOnce",value:function(e){this.waitingListeners.has(e.name)||this.waitingListeners.set(e.name,[]),this.waitingListeners.get(e.name).push(e),e.timeout&&this.startMonitor()}},{key:"once",value:function(e,t,n){this.listenOnce(new d({name:e,onSuccess:t,onError:n}))}},{key:"when",value:function(e,t){var n=this;return new Promise((function(r,a){return n.listenOnce(new d({name:e,timeout:t,onSuccess:function(e){r(e)},onError:function(e){a(e)}}))}))}},{key:"stats",value:function(){return{sent:this.sentCount,received:this.receivedCount}}},{key:"setPartner",value:function(e){this.partnerId=e}},{key:"attach",value:function(e){this.window=e}},{key:"start",value:function(){var e=this;this.debug&&console.log("[windowChannel]["+this.id+"] starting"),this.currentListener=function(t){e.receiveMessage(t)},this.window.addEventListener("message",this.currentListener,!1)}},{key:"stop",value:function(){this.currentListener&&this.window.removeEventListener("message",this.currentListener,!1)}}]),e}();t.Channel=m},1103:function(e,t,n){"use strict";var r=n(23),a=n(44),i=n(45),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1104),u=n(224),c=function(){function e(t){var n=t.itemLifetime,r=t.monitoringFrequency,i=t.waiterTimeout,o=t.waiterFrequency;a(this,e),this.cache=new Map,this.cacheLifetime=n||18e5,this.monitoringFrequency=r||6e4,this.waiterTimeout=i||3e4,this.waiterFrequency=o||100,this.isMonitoring=!1}return i(e,[{key:"runMonitor",value:function(){var e=this;this.isMonitoring||(this.isMonitoring=!0,setTimeout((function(){var t=new Map,n=!1;Object.keys(e.cache).forEach((function(r){var a=e.cache.get(r);e.isExpired(a)||(t.set(r,a),n=!0)})),e.cache=t,e.isMonitoring=!1,n&&e.runMonitor()}),this.monitoringFrequency))}},{key:"isExpired",value:function(e){return(new Date).getTime()-e.createdAt>this.cacheLifetime}},{key:"getItem",value:function(e){if(void 0===this.cache.get(e))return null;var t=this.cache.get(e);if(!this.isExpired(t))return t;this.cache.delete(e)}},{key:"reserveWaiter",value:function(e,t){var n=this;return new Promise((function(r,a){var i=(new Date).getTime();!function o(){setTimeout((function(){var s=n.cache.get(e);if(s){if(s.reserved){var u=(new Date).getTime()-i;return u<n.waiterTimeout?void o():void a(new Error("Timed-out waiting for cache item to become available; timeout "+n.waiterTimeout+", waited "+u))}r(s)}else n.reserveAndFetch(e,t).then((function(){r(n.cache.get(e))})).catch((function(e){a(e)}))}),n.waiterFrequency)}()}))}},{key:"reserveAndFetch",value:function(e,t){var n=this;return this.reserveItem(e,t),t().then((function(r){return n.setItem(e,r,t),r})).finally((function(){}))}},{key:"getItemWithWait",value:function(e){var t=e.id,n=e.fetcher,r=this.cache.get(t);if(r){if(!this.isExpired(r))return r.reserved?this.reserveWaiter(t,n).then((function(e){return e.value})):Promise.resolve(r.value);this.cache.delete(t)}return this.reserveAndFetch(t,n)}},{key:"reserveItem",value:function(e,t){this.cache.set(e,{id:e,createdAt:(new Date).getTime(),reserved:!0,value:null,fetcher:t})}},{key:"setItem",value:function(e,t,n){if(this.cache.has(e)){var r=this.cache.get(e);r&&r.reserved?(r.reserved=!1,r.value=t,r.fetcher=n):this.cache.set(e,{id:e,createdAt:(new Date).getTime(),fetcher:n,reserved:!1,value:t})}else this.cache.set(e,{id:e,createdAt:(new Date).getTime(),fetcher:n,reserved:!1,value:t});this.runMonitor()}}]),e}();t.Cache=c;var l=new c({itemLifetime:18e5,monitoringFrequency:6e4,waiterTimeout:3e4,waiterFrequency:100}),h=1e4,d=function(){function e(t){var n=t.token,r=t.url,i=t.version,o=t.timeout,s=t.rpcContext;if(a(this,e),this.token=n,this.timeout=o||h,this.rpcContext=s||null,!r)throw new Error("The service discovery url was not provided");this.url=r,this.version=i||null,"auto"===i&&(this.version=null)}return i(e,[{key:"options",value:function(){return{timeout:this.timeout,authorization:this.token,rpcContext:this.rpcContext}}},{key:"getModule",value:function(){return this.constructor.module}},{key:"moduleId",value:function(){var e;return e=this.version?this.getModule()+":"+this.version:this.getModule()+":auto",e}},{key:"getCached",value:function(e){return l.getItemWithWait({id:this.moduleId(),fetcher:e})}},{key:"lookupModule",value:function(){return o(this,void 0,void 0,r.mark((function e(){var t=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getCached((function(){var e=new s.ServiceWizardClient({url:t.url,token:t.token,timeout:t.timeout});return Promise.resolve(e.getServiceStatus({module_name:t.getModule(),version:t.version}))})));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"callFunc",value:function(e,t){return o(this,void 0,void 0,r.mark((function n(){var a,i;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.lookupModule();case 2:return a=n.sent,i=new u.AuthorizedGenericClient({module:a.module_name,url:a.url,token:this.token}),n.next=6,i.callFunc(e,t);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n,this)})))}}]),e}();t.DynamicServiceClient=d},1104:function(e,t,n){"use strict";var r=n(23),a=n(44),i=n(45),o=n(55),s=n(53),u=n(56),c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};function l(e,t){return!("object"!==typeof e||!Reflect.has(e,t)||"string"!==typeof Reflect.get(e,t))}function h(e){return!!(l(e,"module_name")&&l(e,"version")&&l(e,"git_commit_hash")&&function(e,t,n){if("object"===typeof e&&Reflect.has(e,t)){var r=Reflect.get(e,t);if("object"===typeof r&&r instanceof Array)return 0===r.length||r.every((function(e){return"string"===typeof e}))}return!1}(e,"release_tags")&&l(e,"url")&&function(e,t){return!("object"!==typeof e||!Reflect.has(e,t)||"number"!==typeof Reflect.get(e,t))}(e,"up")&&l(e,"status")&&l(e,"health"))}Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(){return a(this,t),o(this,s(t).apply(this,arguments))}return u(t,e),i(t,[{key:"getServiceStatus",value:function(e){return c(this,void 0,void 0,r.mark((function t(){var n,a;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.callFunc("get_service_status",e);case 2:if(!((n=t.sent).result&&n.result.length>0)){t.next=14;break}if(a=n.result[0]){t.next=7;break}throw new Error("Crazy as it seems, result is falsy");case 7:if(!h(a)){t.next=11;break}return t.abrupt("return",a);case 11:throw new Error('Sorry, result does not conform to "GetServiceStatusResult"');case 12:t.next=15;break;case 14:throw new Error("Crazy as it seems, no result");case 15:case"end":return t.stop()}}),t,this)})))}}]),t}(n(470).AuthorizedServiceClient);t.ServiceWizardClient=d,d.module="ServiceWizard"},1105:function(e,t,n){"use strict";var r=n(23),a=n(44),i=n(45),o=n(55),s=n(53),u=n(56),c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return a(this,t),o(this,s(t).apply(this,arguments))}return u(t,e),i(t,[{key:"cancelJob",value:function(e){return c(this,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.callFunc("cancel_job",[e]);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"getJobLogs",value:function(e){return c(this,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.callFunc("get_job_logs",[e]);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"checkJob",value:function(e){return c(this,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.callFunc("check_job",[e]);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}}]),t}(n(224).GenericClient);t.default=l,l.module="NarrativeJobService"},1106:function(e,t,n){"use strict";var r=n(23),a=n(92),i=n(44),o=n(45),s=n(55),u=n(53),c=n(56),l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){function t(){return i(this,t),s(this,u(t).apply(this,arguments))}return c(t,e),o(t,[{key:"isAdmin",value:function(){return l(this,void 0,void 0,r.mark((function e(){var t,n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.callFunc("is_admin",[null]);case 3:return t=e.sent,n=a(t,1),i=n[0],e.abrupt("return",i);case 9:throw e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])})))}},{key:"getExecAggrTable",value:function(e){return l(this,void 0,void 0,r.mark((function t(){var n,i,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.callFunc("get_exec_aggr_table",[e]);case 2:return n=t.sent,i=a(n,1),o=i[0],t.abrupt("return",o);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"getExecAggrStats",value:function(e){return l(this,void 0,void 0,r.mark((function t(){var n,i,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.callFunc("get_exec_aggr_stats",[e]);case 2:return n=t.sent,i=a(n,1),o=i[0],t.abrupt("return",o);case 6:case"end":return t.stop()}}),t,this)})))}}]),t}(n(224).GenericClient);t.default=h,h.module="Catalog"},1107:function(e,t,n){"use strict";var r,a=n(92);Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.MILLISECOND=0]="MILLISECOND",e[e.SECOND=1]="SECOND",e[e.MINUTE=2]="MINUTE",e[e.HOUR=3]="HOUR",e[e.DAY=4]="DAY"}(r=t.TimeUnit||(t.TimeUnit={}));var i=[{unit:r.MILLISECOND,long:"millisecond",short:"ms",single:"m",size:1e3},{unit:r.SECOND,long:"second",short:"sec",single:"s",size:60},{unit:r.MINUTE,long:"minute",short:"min",single:"m",size:60},{unit:r.HOUR,long:"hour",short:"hr",single:"h",size:24},{unit:r.DAY,long:"day",short:"day",single:"d",size:30}];function o(e,t,n){switch(t){case"full":var r=" "+e.long;return 1!==n?r+"s":r;case"short":return" "+e.short;case"compact":return e.single}}t.niceRelativeTime=function(e){var t,n,r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=s.now||new Date,c=Math.round((u.getTime()-e.getTime())/1e3),l=Math.abs(c),h=s.format||"compact";if(l<86400*(s.absoluteAfter||90)){if(0===l)return"now";l<60?(t=c,n=l,r=o(i[1],h,n)):l<3600?(t=Math.round(c/60),n=Math.round(l/60),r=o(i[2],h,n)):l<86400?(t=Math.round(c/3600),n=Math.round(l/3600),r=o(i[3],h,n)):(t=Math.round(c/86400),n=Math.round(l/86400),r=o(i[4],h,n));var d=a(t<0?["in",null]:[null,"ago"],2),p=d[0],f=d[1];return(p?p+" ":"")+n+r+(f?" "+f:"")}return"compact"===s.format&&u.getFullYear()===e.getFullYear()?Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(e):Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)},t.niceDuration=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],r=t.format||"compact",a=Math.abs(e),s=i.map((function(e){var t=a%e.size;return a=(a-t)/e.size,{label:o(e,r,t),value:t}})).reverse();s.pop();for(var u=!1,c=0;c<s.length;c+=1){if(!u){if(!(s[c].value>0))continue;u=!0}if(t.precision&&t.precision===n.length)break;n.push(s[c])}return 0===n.length?"<"+("compact"!==r?" ":"")+"1"+o(i[1],r,1):n.map((function(e){return String(e.value)+e.label})).join(" ")},t.niceElapsed=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],r=t.format||"compact",a=Math.abs(e),s=i.map((function(e){var t=a%e.size;return a=(a-t)/e.size,{label:o(e,r,t),value:t}})).reverse();s.pop();for(var u=!1,c=0;c<s.length;c+=1){if(!u){if(!(s[c].value>0))continue;u=!0}if(t.precision&&t.precision===n.length)break;n.push(s[c])}return 0===n.length?["<"+("compact"!==r?" ":"")+"1"+o(i[1],r,1),n]:[n.map((function(e){return String(e.value)+e.label})).join(" "),n]}},1108:function(e,t,n){"use strict";var r=n(23),a=n(92),i=n(44),o=n(45),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l,h=u(n(1109)),d=c(n(471));!function(e){e[e.NONE=0]="NONE",e[e.AUTHENTICATED=1]="AUTHENTICATED",e[e.UNAUTHENTICATED=2]="UNAUTHENTICATED",e[e.ERROR=3]="ERROR"}(l=t.AuthState||(t.AuthState={}));var p=function(){function e(t){i(this,e),this.url=t}return o(e,[{key:"checkAuth",value:function(){return s(this,void 0,void 0,r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.get("kbase_session")){e.next=3;break}return e.abrupt("return",Promise.resolve({status:l.UNAUTHENTICATED,userAuthorization:null}));case 3:return n=new d.default({url:this.url}),e.abrupt("return",Promise.all([n.getTokenInfo(t),n.getMe(t)]).then((function(e){var n=a(e,2),r=(n[0],n[1]),i=r.roles.map((function(e){var t=e.id;e.desc;return t}));return{status:l.AUTHENTICATED,userAuthorization:{token:t,username:r.user,realname:r.display,roles:i}}})).catch((function(e){return{status:l.UNAUTHENTICATED,userAuthorization:null}})));case 5:case"end":return e.stop()}}),e,this)})))}}]),e}();t.default=p},1110:function(e,t,n){},1146:function(e,t,n){},1147:function(e,t,n){},1148:function(e,t,n){},1149:function(e,t,n){},1150:function(e,t,n){"use strict";n.r(t);var r,a=n(0),i=n.n(a),o=n(17),s=n.n(o),u=(n(524),n(32)),c=n(33),l=n(37),h=n(36),d=n(38),p=n(89),f=n(28);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.MAIN_LOAD="main load",e.MAIN_LOAD_START="main load start",e.MAIN_LOAD_SUCCESS="main load success",e.MAIN_LOAD_ERROR="main load error",e.MAIN_UNLOAD="main/unload",e.MY_JOBS_SEARCH="my jobs search",e.MY_JOBS_SEARCH_START="my jobs search start",e.MY_JOBS_SEARCH_SUCCESS="my jobs search success",e.MY_JOBS_SEARCH_ERROR="my jobs search error",e.My_JOBS_REFRESH_SEARCH="my jobs refresh search",e.MY_JOBS_CANCEL="my jobs cancel",e.MY_JOBS_CANCEL_START="my jobs cancel start",e.MY_JOBS_CANCEL_SUCCESS="my jobs cancel success",e.MY_JOBS_CANCEL_ERROR="my jobs cancel error",e.USER_JOBS_SEARCH="user jobs search",e.USER_JOBS_SEARCH_START="user jobs search start",e.USER_JOBS_SEARCH_SUCCESS="user jobs search success",e.USER_JOBS_SEARCH_ERROR="user jobs search error",e.USER_JOBS_CANCEL="user jobs cancel",e.USER_JOBS_CANCEL_START="user jobs cancel start",e.USER_JOBS_CANCEL_SUCCESS="user jobs cancel success",e.USER_JOBS_CANCEL_ERROR="user jobs cancel error",e.PUBLIC_APP_STATS_SEARCH="publicAppStats/Search",e.PUBLIC_APP_STATS_SEARCH_START="publicAppStats/Search/Start",e.PUBLIC_APP_STATS_SEARCH_ERROR="publicAppStats/Search/Error",e.PUBLIC_APP_STATS_SEARCH_SUCCESS="publicAppStats/Search/Success",e.USER_RUN_SUMMARY_SEARCH="userRunSummary/Search",e.USER_RUN_SUMMARY_SEARCH_START="userRunSummary/Search/Start",e.USER_RUN_SUMMARY_SEARCH_ERROR="userRunSummary/Search/Error",e.USER_RUN_SUMMARY_SEARCH_SUCCESS="userRunSummary/Search/Success"}(r||(r={}));var E=function(e,t){if(!e)return e;switch(t.type){case r.MY_JOBS_SEARCH_SUCCESS:return function(e,t){return v({},e,{views:v({},e.views,{myJobsView:v({},e.views.myJobsView,{searchState:N.SEARCHED,rawJobs:t.rawJobs,jobs:t.jobs,jobsFetchedAt:t.jobsFetchedAt,searchExpression:t.searchExpression})})})}(e,t);case r.MY_JOBS_SEARCH_START:return function(e,t){return v({},e,{views:v({},e.views,{myJobsView:v({},e.views.myJobsView,{searchState:N.SEARCHING})})})}(e);case r.MY_JOBS_CANCEL_SUCCESS:return function(e,t){return v({},e,{views:v({},e.views,{myJobsView:v({},e.views.myJobsView)})})}(e)}};function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e,t){if(!e)return e;switch(t.type){case r.USER_JOBS_SEARCH_START:return function(e,t){return g({},e,{views:g({},e.views,{userJobsView:g({},e.views.userJobsView,{searchState:N.SEARCHING})})})}(e);case r.USER_JOBS_SEARCH_SUCCESS:return function(e,t){return g({},e,{views:g({},e.views,{userJobsView:g({},e.views.userJobsView,{searchState:N.SEARCHED,rawJobs:t.rawJobs,jobs:t.jobs,jobsFetchedAt:t.jobsFetchedAt,searchExpression:t.searchExpression})})})}(e,t);case r.USER_JOBS_CANCEL_START:case r.USER_JOBS_CANCEL_SUCCESS:return function(e,t){return g({},e,{views:g({},e.views,{userJobsView:g({},e.views.userJobsView)})})}(e)}};function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e,t){if(!e)return e;switch(t.type){case r.MAIN_LOAD_SUCCESS:return function(e,t){return w({},e,{views:w({},e.views,{mainView:w({},e.views.mainView,{loadingState:D.SUCCESS,isAdmin:t.isAdmin})})})}(e,t);case r.MAIN_UNLOAD:return function(e,t){return w({},e,{views:w({},e.views,{mainView:{loadingState:D.NONE,isAdmin:!1,error:null}})})}(e)}};function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=function(e,t){if(!e)return e;switch(t.type){case r.PUBLIC_APP_STATS_SEARCH_START:return function(e,t){return A({},e,{views:A({},e.views,{publicAppStatsView:A({},e.views.publicAppStatsView,{searchState:N.SEARCHING})})})}(e);case r.PUBLIC_APP_STATS_SEARCH_SUCCESS:return function(e,t){return A({},e,{views:A({},e.views,{publicAppStatsView:A({},e.views.publicAppStatsView,{searchState:N.SEARCHED,appStats:t.appStats})})})}(e,t)}};function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T,N,D,I=function(e,t){if(!e)return e;switch(t.type){case r.USER_RUN_SUMMARY_SEARCH_START:return function(e,t){return C({},e,{views:C({},e.views,{userRunSummaryView:C({},e.views.userRunSummaryView,{searchState:N.SEARCHING})})})}(e);case r.USER_RUN_SUMMARY_SEARCH_SUCCESS:return function(e,t){return C({},e,{views:C({},e.views,{userRunSummaryView:C({},e.views.userRunSummaryView,{searchState:N.SEARCHED,userRunSummary:t.userRunSummary})})})}(e,t)}},j=function(e,t){var n=Object(f.baseReducer)(e,t);return n||(_(e,t)||E(e,t)||y(e,t)||R(e,t)||I(e,t)||e)},U=n(171),P=n(503);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(){var e=[];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(f.makeBaseStoreState)(),{views:{mainView:{loadingState:D.NONE,error:null,isAdmin:!1},myJobsView:{searchState:N.NONE,searchExpression:null,jobsFetchedAt:null,rawJobs:e,jobs:e},userJobsView:{searchState:N.NONE,searchExpression:null,jobsFetchedAt:null,rawJobs:e,jobs:e},publicAppStatsView:{searchState:N.NONE,rawAppStats:[],appStats:[],query:{query:""}},userRunSummaryView:{searchState:N.NONE,userRunSummary:[],query:{query:""}}}})}!function(e){e.QUEUED="QUEUED",e.RUNNING="RUNNING",e.FINISHED="FINISHED",e.ERRORED="ERRORED",e.CANCELED_QUEUED="CANCELED_QUEUED",e.CANCELED_RUNNING="CANCELED_RUNNING"}(T||(T={})),function(e){e[e.NONE=0]="NONE",e[e.SEARCHING=1]="SEARCHING",e[e.SEARCHED=2]="SEARCHED",e[e.ERROR=3]="ERROR"}(N||(N={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.ERROR=3]="ERROR"}(D||(D={}));var M=n(62),J=(n(295),n(127)),F=(n(156),n(72)),H=(n(426),n(19)),z=(n(910),n(190),n(29)),G=(n(138),n(50)),Q=(n(428),n(239)),V=(n(297),n(107)),q=(n(299),n(169)),W=(n(298),n(67)),B=(n(184),n(123)),Y=(n(225),n(46)),K=(n(477),n(173)),Z=(n(478),n(238)),X=(n(96),n(31)),$=n(26),ee=n.n($),te=(n(429),n(240));function ne(e){switch(e){case T.QUEUED:return"orange";case T.RUNNING:return"blue";case T.CANCELED_QUEUED:case T.CANCELED_RUNNING:return"gray";case T.FINISHED:return"green";case T.ERRORED:return"red";default:throw new Error("Invalid job status")}}var re,ae=function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderTag",value:function(){var e=function(e){switch(e){case T.QUEUED:return i.a.createElement("span",null,i.a.createElement(H.a,{type:"loading",spin:!0})," Queued");case T.RUNNING:return i.a.createElement("span",null,i.a.createElement(H.a,{type:"loading-3-quarters",spin:!0})," Running");case T.CANCELED_QUEUED:case T.CANCELED_RUNNING:return"Canceled";case T.FINISHED:return"Success";case T.ERRORED:return"Errored";default:throw new Error("Invalid job status")}}(this.props.job.status),t=ne(this.props.job.status);return i.a.createElement(te.a,{color:t},e)}},{key:"renderTiming",value:function(){switch(this.props.job.status){case T.QUEUED:return i.a.createElement("span",null,i.a.createElement(f.NiceElapsedTime,{from:this.props.job.queuedAt,useClock:!0}));case T.RUNNING:return i.a.createElement("span",null,i.a.createElement(f.NiceElapsedTime,{from:this.props.job.runAt,useClock:!0}));case T.FINISHED:case T.ERRORED:case T.CANCELED_QUEUED:case T.CANCELED_RUNNING:return i.a.createElement("span",null,i.a.createElement(f.NiceRelativeTime,{time:new Date(this.props.job.finishAt)}))}}},{key:"render",value:function(){var e=this.props.showTiming?this.renderTiming():"";return i.a.createElement("span",null,this.renderTag(),e)}}]),t}(i.a.Component),ie=n(78),oe=n(23),se=n.n(oe),ue=n(52),ce=(n(971),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={selectedTabIndex:0},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"selectTab",value:function(e){this.setState({selectedTabIndex:e})}},{key:"renderTabs",value:function(){var e=this;return this.props.tabs.map((function(t,n){var r=["FlexTabs-tab"];return n===e.state.selectedTabIndex&&r.push("FlexTabs-tab-active"),i.a.createElement("span",{key:String(n),className:r.join(" ")},i.a.createElement(X.a,{type:"link",onClick:function(){e.selectTab(n)}},t.title))}))}},{key:"renderTabBody",value:function(){return this.props.tabs[this.state.selectedTabIndex].component}},{key:"render",value:function(){return i.a.createElement("div",{className:"FlexTabs"},i.a.createElement("div",{className:"FlexTabs-header"},this.renderTabs()),i.a.createElement("div",{className:"FlexTabs-body"},this.renderTabBody()))}}]),t}(i.a.Component)),le=(n(427),n(170)),he=(n(972),n(111)),de=(n(296),n(128)),pe=(n(974),n(330)),fe=n.n(pe),me=n(510),ve=n.n(me);!function(e){e[e.NONE=0]="NONE",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED",e[e.DISABLED=3]="DISABLED"}(re||(re={}));var Ee=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).playLogTimer=void 0,n.bodyRef=void 0,n.currentJobStatus=void 0,n.playLogTimer=0,n.bodyRef=i.a.createRef(),n.currentJobStatus=null,n.state={playState:re.NONE,isPaused:!1},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.currentJobStatus=this.props.job.status,this.state.isPaused||this.isActive()&&this.scrollToBottom()}},{key:"scrollToBottom",value:function(){null!==this.bodyRef.current&&(this.bodyRef.current.scrollTop=this.bodyRef.current.scrollHeight)}},{key:"componentDidUpdate",value:function(){var e=this.currentJobStatus;this.currentJobStatus=this.props.job.status,this.state.isPaused||(this.isActive()||e!==T.RUNNING||this.props.job.status!==T.RUNNING)&&this.scrollToBottom()}},{key:"isActive",value:function(){return this.props.job.status===T.QUEUED||this.props.job.status===T.RUNNING}},{key:"renderLastLine",value:function(){var e;return e=this.isActive()?i.a.createElement("span",null,"Polling for additional log entries..."," ",i.a.createElement(F.a,{size:"small"})):i.a.createElement("div",{style:{textAlign:"center",fontStyle:"italic"}},"Log complete"),i.a.createElement("div",{className:"FlexTable-row",key:"END",style:{backgroundColor:"rgba(200, 200, 200, 0.5)"},"data-end":"end"},i.a.createElement("div",{className:"FlexTable-col"}),i.a.createElement("div",{className:"FlexTable-col"},e))}},{key:"renderJobLog",value:function(){var e=this.props.log;if(0===e.length)return i.a.createElement(de.a,null);var t=e.map((function(e){var t={};return e.isError&&(t.color="red"),i.a.createElement("div",{className:"FlexTable-row",style:t,key:e.lineNumber},i.a.createElement("div",{className:"FlexTable-col"},e.lineNumber),i.a.createElement("div",{className:"FlexTable-col"},e.line))}));return t.push(this.renderLastLine()),i.a.createElement("div",{className:"FlexTable",key:"log"},i.a.createElement("div",{className:"FlexTable-header"},i.a.createElement("div",{className:"FlexTable-row"},i.a.createElement("div",{className:"FlexTable-col"},"Line #"),i.a.createElement("div",{className:"FlexTable-col"},"Log line"))),i.a.createElement("div",{className:"FlexTable-body",ref:this.bodyRef},t))}},{key:"renderJobLogRow",value:function(){}},{key:"renderJobLogLines",value:function(){return i.a.createElement(z.a,{dataSource:this.props.log,size:"small",rowKey:function(e){return String(e.lineNumber)},pagination:!1,scroll:{y:"100%"},rowClassName:function(e){return e.isError?"JobLog-errorRow":"JobLog-normalRow"}},i.a.createElement(z.a.Column,{title:"Row",dataIndex:"lineNumber",key:"lineNumber",width:"8%",render:function(e,t){var n=new Intl.NumberFormat("en-US",{useGrouping:!0}).format(e);return t.isError?i.a.createElement("span",{className:"JobLog-errorText"},n):n},sorter:function(e,t){return e.lineNumber-t.lineNumber}}),i.a.createElement(z.a.Column,{title:"Log line",dataIndex:"line",key:"line",width:"92%",render:function(e,t){var n;return n=t.isError?i.a.createElement("span",{className:"JobLog-errorText"},e):i.a.createElement("span",null,e),i.a.createElement(G.a,{title:e},n)}}))}},{key:"downloadLog",value:function(e,t){var n,r;switch(e){case"tsv":n="application/octet-stream",r=function(e){return fe.a.unparse(e,{delimiter:"\t"})}(t);break;case"json":n="application/octet-stream",r=function(e){return JSON.stringify(e)}(t);break;case"text":n="text/plain",r=function(e){return e.map((function(e){return e.line})).join("\n")}(t);break;default:case"csv":n="application/octet-stream",r=function(e){return fe.a.unparse(e)}(t)}!function(e,t,n){var r=document.createElement("a"),a=new Blob([n]);r.href=URL.createObjectURL(a),r.download=e,r.style.visibility="none",r.type=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(r.href)}("job-log."+e,n,r)}},{key:"onMenuClick",value:function(e){e&&this.downloadLog(e.key,this.props.log)}},{key:"onPlayLog",value:function(){this.scrollToBottom(),this.setState({playState:re.PLAYING,isPaused:!1})}},{key:"onPauseLog",value:function(){this.setState({playState:re.PAUSED,isPaused:!0})}},{key:"renderPlayPauseTooltips",value:function(){var e,t,n=this.state.isPaused;switch(this.props.job.status){case T.RUNNING:n?(e="Click to automatically scroll to the bottom of the logs when new entries arrive",t="Automatic scrolling is already paused"):(e="Automatic scrolling is already active",t="Click to pause automatic scrolling to the bottom of the logs when new entries arrive");break;case T.QUEUED:case T.FINISHED:case T.ERRORED:case T.CANCELED_QUEUED:case T.CANCELED_RUNNING:default:e="Log playing only available when the job is running",t="Log playing only available when the job is running"}return[e,t]}},{key:"renderPlayPause",value:function(){var e;switch(this.props.job.status){case T.QUEUED:e=!0;break;case T.RUNNING:e=!1;break;case T.FINISHED:case T.ERRORED:case T.CANCELED_QUEUED:case T.CANCELED_RUNNING:default:e=!0}var t=this.renderPlayPauseTooltips(),n=Object(ie.a)(t,2),r=n[0],a=n[1];return i.a.createElement(ve.a,null,i.a.createElement(G.a,{title:r},i.a.createElement(X.a,{icon:"caret-right",disabled:e||!this.state.isPaused,onClick:this.onPlayLog.bind(this)})),i.a.createElement(G.a,{title:a},i.a.createElement(X.a,{icon:"pause",disabled:e||this.state.isPaused,onClick:this.onPauseLog.bind(this)})))}},{key:"renderToolbar",value:function(){var e=0===this.props.log.length,t=i.a.createElement(he.a,{onClick:this.onMenuClick.bind(this)},i.a.createElement(he.a.Item,{key:"csv",disabled:e},"CSV"),i.a.createElement(he.a.Item,{key:"tsv",disabled:e},"TSV"),i.a.createElement(he.a.Item,{key:"json",disabled:e},"JSON"),i.a.createElement(he.a.Item,{key:"text",disabled:e},"TEXT"));return i.a.createElement("div",{key:"toolbar"},i.a.createElement(le.a,{overlay:t},i.a.createElement(X.a,{icon:"download"}))," ",this.renderPlayPause())}},{key:"render",value:function(){return i.a.createElement("div",{className:"JobLog"},this.renderToolbar(),this.renderJobLog())}}]),t}(i.a.Component),be=function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderSubmitted",value:function(){var e=this.props.job.queuedAt;return e?i.a.createElement(f.NiceRelativeTime,{time:new Date(e)}):i.a.createElement("span",null,"** empty **")}},{key:"renderQueuedFor",value:function(){var e=this.props.job;switch(e.status){case T.QUEUED:return i.a.createElement(f.NiceElapsedTime,{from:e.queuedAt,precision:2,useClock:!0});case T.RUNNING:case T.FINISHED:return i.a.createElement(f.NiceElapsedTime,{from:e.queuedAt,to:e.runAt,precision:2});case T.CANCELED_QUEUED:return i.a.createElement(f.NiceElapsedTime,{from:e.queuedAt,to:e.finishAt,precision:2});case T.CANCELED_RUNNING:case T.ERRORED:return i.a.createElement(f.NiceElapsedTime,{from:e.queuedAt,to:e.runAt,precision:2})}}},{key:"renderRunFor",value:function(){var e=this.props.job;switch(e.status){case T.QUEUED:return i.a.createElement("span",null,"-");case T.RUNNING:return i.a.createElement(f.NiceElapsedTime,{from:e.runAt,precision:2,useClock:!0});case T.FINISHED:return i.a.createElement(f.NiceElapsedTime,{from:e.runAt,to:e.finishAt,precision:2});case T.CANCELED_QUEUED:return i.a.createElement("span",null,"-");case T.CANCELED_RUNNING:case T.ERRORED:return i.a.createElement(f.NiceElapsedTime,{from:e.runAt,to:e.finishAt,precision:2})}}},{key:"renderStateSpinner",value:function(e){if(this.props.job.status===e)return i.a.createElement("span",null," ",i.a.createElement(F.a,{size:"small",style:{color:ne(e)}}))}},{key:"render",value:function(){return i.a.createElement("div",{className:"JobInfo InfoTable"},i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol"},"Job ID"),i.a.createElement("div",{className:"InfoTable-dataCol"},this.props.job.id)),i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol"},"Status"),i.a.createElement("div",{className:"InfoTable-dataCol"},i.a.createElement(ae,{job:this.props.job}))),i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol"},"Narrative"),i.a.createElement("div",{className:"InfoTable-dataCol"},i.a.createElement("a",{href:"/narrative/".concat(this.props.job.narrativeID),target:"_blank",rel:"noopener noreferrer"},this.props.job.narrativeTitle))),i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol"},"App"),i.a.createElement("div",{className:"InfoTable-dataCol"},i.a.createElement("a",{href:"/#catalog/apps/".concat(this.props.job.appID)},this.props.job.appTitle))),i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol"},"Submitted"),i.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSubmitted())),i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol"},"Queued For"),i.a.createElement("div",{className:"InfoTable-dataCol"},this.renderQueuedFor(),this.renderStateSpinner(T.QUEUED))),i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol"},"Run For"),i.a.createElement("div",{className:"InfoTable-dataCol"},this.renderRunFor(),this.renderStateSpinner(T.RUNNING))))}}]),t}(i.a.Component),ge=(n(1082),function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderLoading",value:function(){return i.a.createElement("div",{className:"FullyCenteredBox"},i.a.createElement("span",null,"Loading ... ",i.a.createElement(F.a,null)))}},{key:"renderQueued",value:function(){return i.a.createElement("div",{className:"FullyCenteredBox"},i.a.createElement("span",null,"The job is ",i.a.createElement("i",null,"queued"),". The log will be displayed when the job starts running ... ",i.a.createElement(F.a,null)))}},{key:"renderError",value:function(e){return i.a.createElement(J.a,{type:"error",message:e.error})}},{key:"renderJobLog",value:function(){switch(this.props.view.status){case Ae.NONE:case Ae.JOB_QUEUED:return this.renderQueued();case Ae.INITIAL_LOADING:return this.renderLoading();case Ae.ERROR:return this.renderError(this.props.view);case Ae.ACTIVE_LOADED:case Ae.ACTIVE_LOADING:case Ae.FINISHED_LOADED:return i.a.createElement(Ee,{job:this.props.view.job,log:this.props.view.log})}}},{key:"renderJobInfo",value:function(){switch(this.props.view.status){case Ae.NONE:return this.renderLoading();case Ae.JOB_QUEUED:return i.a.createElement(be,{job:this.props.view.job});case Ae.INITIAL_LOADING:return this.renderLoading();case Ae.ERROR:return this.renderError(this.props.view);case Ae.ACTIVE_LOADED:case Ae.ACTIVE_LOADING:case Ae.FINISHED_LOADED:return i.a.createElement(be,{job:this.props.view.job})}}},{key:"renderTest",value:function(){var e=Array.from(Array(100).keys()).map((function(e){return i.a.createElement("div",{style:{flex:"0 0 auto",display:"flex",flexDirection:"row",borderBottom:"1px silver solid"},key:String(e)},i.a.createElement("div",{style:{flex:"0 0 auto",padding:"4px",overflowWrap:"break-word",wordWrap:"break-word"}},e))}));return i.a.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"column",minHeight:0}},i.a.createElement("div",null,"Header Here"),i.a.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"column",minHeight:0,overflowY:"auto"}},e))}},{key:"renderTest2",value:function(){var e=Array.from(Array(100).keys()).map((function(e){return i.a.createElement("div",{className:"FlexTable-row",key:String(e)},i.a.createElement("div",{className:"FlexTable-col"},e),i.a.createElement("div",{className:"FlexTable-col"},"This is row ",e))}));return i.a.createElement("div",{className:"FlexTable"},i.a.createElement("div",{className:"FlexTable-header"},i.a.createElement("div",{className:"FlexTable-row"},i.a.createElement("div",{className:"FlexTable-col"},"#"),i.a.createElement("div",{className:"FlexTable-col"},"Data"))),i.a.createElement("div",{className:"FlexTable-body"},e))}},{key:"renderStatus",value:function(){switch(this.props.view.status){case Ae.NONE:case Ae.INITIAL_LOADING:return i.a.createElement(F.a,{size:"small"});case Ae.ERROR:return i.a.createElement(J.a,{type:"error",message:this.props.view.error});default:return i.a.createElement(ae,{job:this.props.view.job,showTiming:!0})}}},{key:"renderMiniDetails",value:function(){return i.a.createElement("div",{style:{flex:"0 0 auto"}},this.renderStatus())}},{key:"render",value:function(){var e=[{tab:"log",title:"Log",component:this.renderJobLog()},{tab:"detail",title:"Detail",component:this.renderJobInfo()}];return i.a.createElement(i.a.Fragment,null,this.renderMiniDetails(),i.a.createElement(ce,{tabs:e}))}}]),t}(i.a.Component)),ye=n(77),Se=function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getJobs",value:function(){var e=Object(ue.a)(se.a.mark((function e(t){var n,r,a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.epoch_range,r=t.user_ids,e.next=3,this.callFunc("get_jobs",[{epoch_range:n,user_ids:r}]);case 3:return a=e.sent,e.abrupt("return",a[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getJob",value:function(){var e=Object(ue.a)(se.a.mark((function e(t){var n,r;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.job_id,e.next=3,this.callFunc("get_job",[{job_id:n}]);case 3:return r=e.sent,e.abrupt("return",r[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAppMetrics",value:function(){var e=Object(ue.a)(se.a.mark((function e(t){var n,r,a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.epoch_range,r=t.user_ids,e.next=3,this.callFunc("get_job",[{epoch_range:n,user_ids:r}]);case 3:return a=e.sent,e.abrupt("return",a[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(ye.DynamicServiceClient);function we(e,t){switch(function(e){switch(e.state){case"QUEUED":return T.QUEUED;case"RUNNING":return T.RUNNING;case"FINISHED":return T.FINISHED;case"CANCELED_QUEUED":case"CANCELED_RUNNING":return T.CANCELED_QUEUED;case"ERRORED":return T.ERRORED;case"ERRORED_QUEUED":return console.warn("ERRORED_QUEUED",e),T.ERRORED;default:throw new Error("Unknown job state: "+e.state)}}(e)){case T.QUEUED:return function(e,t){var n;return n=e.wsid?parseInt(e.wsid,10):null,{key:e.job_id,id:e.job_id,status:T.QUEUED,appID:e.app_id,appTitle:e.app_id,narrativeID:n,narrativeTitle:e.narrative_name,queuedAt:e.creation_time,queuedElapsed:Date.now()-e.creation_time,clientGroups:e.client_groups,username:e.user||t}}(e,t);case T.RUNNING:return function(e,t){var n;if(n=e.wsid?parseInt(e.wsid,10):null,!e.exec_start_time)throw new Error("Running job without exec_start_time!");return{key:e.job_id,id:e.job_id,status:T.RUNNING,appID:e.app_id,appTitle:e.app_id,narrativeID:n,narrativeTitle:e.narrative_name,queuedAt:e.creation_time,runAt:e.exec_start_time,runElapsed:Date.now()-e.exec_start_time,queuedElapsed:Date.now()-e.creation_time,clientGroups:e.client_groups,username:e.user||t}}(e,t);case T.FINISHED:return function(e,t){var n;if(n=e.wsid?parseInt(e.wsid,10):null,!e.exec_start_time)throw new Error("Running job without exec_start_time!");if(!e.finish_time)throw new Error("Running job without finish_time!");return{key:e.job_id,id:e.job_id,status:T.FINISHED,appID:e.app_id,appTitle:e.app_id,narrativeID:n,narrativeTitle:e.narrative_name,queuedAt:e.creation_time,runAt:e.exec_start_time,runElapsed:e.finish_time-e.exec_start_time,finishAt:e.finish_time,queuedElapsed:Date.now()-e.creation_time,clientGroups:e.client_groups,username:e.user||t}}(e,t);case T.ERRORED:return function(e,t){var n;if(n=e.wsid?parseInt(e.wsid,10):null,!e.exec_start_time)throw new Error("Errored job without exec_start_time!");if(!e.finish_time)throw new Error("Errored job without finish_time!");return{key:e.job_id,id:e.job_id,status:T.ERRORED,appID:e.app_id,appTitle:e.app_id,narrativeID:n,narrativeTitle:e.narrative_name,queuedAt:e.creation_time,runAt:e.exec_start_time,runElapsed:e.finish_time-e.exec_start_time,finishAt:e.finish_time,queuedElapsed:Date.now()-e.creation_time,clientGroups:e.client_groups,message:e.status,username:e.user||t}}(e,t);case T.CANCELED_QUEUED:return function(e,t){var n;if(n=e.wsid?parseInt(e.wsid,10):null,!e.finish_time)throw new Error("Canceled job without finish_time!");return{key:e.job_id,id:e.job_id,status:T.CANCELED_QUEUED,appID:e.app_id,appTitle:e.app_id,narrativeID:n,narrativeTitle:e.narrative_name,queuedAt:e.creation_time,queuedElapsed:Date.now()-e.creation_time,clientGroups:e.client_groups,finishAt:e.finish_time,username:e.user||t}}(e,t);case T.CANCELED_RUNNING:return function(e,t){var n;if(n=e.wsid?parseInt(e.wsid,10):null,!e.exec_start_time)throw new Error("Canceled job without exec_start_time!");if(!e.finish_time)throw new Error("Canceled job without finish_time!");return{key:e.job_id,id:e.job_id,status:T.CANCELED_RUNNING,appID:e.app_id,appTitle:e.app_id,narrativeID:n,narrativeTitle:e.narrative_name,queuedAt:e.creation_time,runAt:e.exec_start_time,runElapsed:e.finish_time-e.exec_start_time,finishAt:e.finish_time,queuedElapsed:Date.now()-e.creation_time,clientGroups:e.client_groups,username:e.user||t}}(e,t);default:throw new Error("Invalid job status: "+e.status)}}function _e(e,t){return!t||t.some((function(t){return e.status===t}))}function ke(e){switch(e.kind){case"preset":return function(e){var t=(new Date).getTime();switch(e){case"lastHour":return[t-36e5,t];case"last48Hours":return[t-1728e5,t];case"lastWeek":return[t-6048e5,t];case"lastMonth":return[t-2592e6,t]}}(e.preset);case"literal":return[e.start,e.end];default:throw new Error("Invalid time range kind value (should be impossible")}}Se.module="kb_Metrics";var Ae;!function(e){e[e.NONE=0]="NONE",e[e.JOB_QUEUED=1]="JOB_QUEUED",e[e.INITIAL_LOADING=2]="INITIAL_LOADING",e[e.ACTIVE_LOADED=3]="ACTIVE_LOADED",e[e.ACTIVE_LOADING=4]="ACTIVE_LOADING",e[e.FINISHED_LOADED=5]="FINISHED_LOADED",e[e.ERROR=6]="ERROR"}(Ae||(Ae={}));var Re=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={status:Ae.NONE},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getJob",value:function(){var e=Object(ue.a)(se.a.mark((function e(){var t,n,r;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Se({token:this.props.token,url:this.props.serviceWizardURL}),n=this.props.jobID,e.next=4,t.getJob({job_id:n});case 4:return r=e.sent,e.abrupt("return",we(r.job_state,"UNKNOWN"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getJobLog",value:function(){var e=Object(ue.a)(se.a.mark((function e(t){var n,r,a,i;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ye.NarrativeJobServiceClient({token:this.props.token,url:this.props.njsURL,module:"NarrativeJobService"}),e.next=3,n.getJobLogs({job_id:this.props.jobID,skip_lines:t});case 3:return r=e.sent,a=Object(ie.a)(r,1),i=a[0],e.abrupt("return",i.lines.map((function(e,n){return{lineNumber:t+n+1,line:e.line,isError:!!e.is_error}})));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"startRunningPolling",value:function(){var e=this,t=function(){var t=Object(ue.a)(se.a.mark((function t(){var r,a,i,o,s;return se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.state,console.log("poller"),r.status===Ae.ACTIVE_LOADED){t.next=5;break}return e.setState({status:Ae.ERROR,error:"Invalid state for polling: "+r.status}),t.abrupt("return");case 5:return a=r.log,e.setState({status:Ae.ACTIVE_LOADING,log:a}),t.next=9,e.getJob();case 9:return i=t.sent,o=a.length,t.next=13,e.getJobLog(o);case 13:s=t.sent,console.log("  job",i,s),t.t0=i.status,t.next=t.t0===T.QUEUED?18:t.t0===T.RUNNING?20:t.t0===T.FINISHED?23:t.t0===T.ERRORED?23:t.t0===T.CANCELED_RUNNING?23:t.t0===T.CANCELED_QUEUED?23:24;break;case 18:return e.startQueuedPolling(),t.abrupt("break",24);case 20:return e.setState({status:Ae.ACTIVE_LOADED,log:a.concat(s),job:i}),n(),t.abrupt("break",24);case 23:e.setState({status:Ae.FINISHED_LOADED,log:a.concat(s),job:i});case 24:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=function(){setTimeout(t,5e3)};n()}},{key:"startQueuedPolling",value:function(){var e=this,t=function(){var t=Object(ue.a)(se.a.mark((function t(){var r,a;return se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getJob();case 2:r=t.sent,console.log("queued polling..."),t.t0=r.status,t.next=t.t0===T.QUEUED?7:9;break;case 7:return n(),t.abrupt("return");case 9:return t.next=11,e.getJobLog(0);case 11:a=t.sent,t.t1=r.status,t.next=t.t1===T.RUNNING?15:t.t1===T.FINISHED?18:t.t1===T.ERRORED?18:t.t1===T.CANCELED_QUEUED?18:t.t1===T.CANCELED_RUNNING?18:20;break;case 15:return e.setState({status:Ae.ACTIVE_LOADED,log:a,job:r}),e.startRunningPolling(),t.abrupt("break",20);case 18:return e.setState({status:Ae.FINISHED_LOADED,log:a,job:r}),t.abrupt("break",20);case 20:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=function(){setTimeout(t,5e3)};n()}},{key:"getInitialJobLog",value:function(){var e=Object(ue.a)(se.a.mark((function e(){var t,n;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({status:Ae.INITIAL_LOADING}),e.next=3,this.getJob();case 3:t=e.sent,e.t0=t.status,e.next=e.t0===T.QUEUED?7:e.t0===T.RUNNING?10:e.t0===T.FINISHED?16:e.t0===T.ERRORED?16:e.t0===T.CANCELED_QUEUED?16:e.t0===T.CANCELED_RUNNING?16:21;break;case 7:return this.setState({status:Ae.JOB_QUEUED,job:t}),this.startQueuedPolling(),e.abrupt("return");case 10:return e.next=12,this.getJobLog(0);case 12:return n=e.sent,this.setState({status:Ae.ACTIVE_LOADED,log:n,job:t}),this.startRunningPolling(),e.abrupt("return");case 16:return e.next=18,this.getJobLog(0);case 18:return n=e.sent,this.setState({status:Ae.FINISHED_LOADED,log:n,job:t}),e.abrupt("return");case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getInitialJobLog()}},{key:"renderLoading",value:function(){return i.a.createElement("div",null,"Loading ... ",i.a.createElement(F.a,null))}},{key:"renderQueued",value:function(){return i.a.createElement("div",null,"Queued ... ",i.a.createElement(F.a,null))}},{key:"renderError",value:function(e){return i.a.createElement(J.a,{type:"error",message:e.error})}},{key:"render",value:function(){return i.a.createElement(ge,{view:this.state})}}]),t}(i.a.Component);var Oe,Ce=Object(M.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config.services,a=r.NarrativeJobService.url,i=r.ServiceWizard.url;if(!n)throw new Error("Invalid state: token required");return{token:n.token,njsURL:a,serviceWizardURL:i}}),(function(e,t){return{}}))(Re),Te=(n(1110),n(472),n(193)),Ne=n(228),De=n(237),Ie=n.n(De),je=function(){function e(t){Object(u.a)(this,e),this.subscriptions=void 0,this.pubsub=void 0,this.subscriptions=[],this.pubsub=t}return Object(c.a)(e,[{key:"on",value:function(e,t){var n=this.pubsub.on(e,t);this.subscriptions.push(n)}},{key:"off",value:function(){var e=this;this.subscriptions.forEach((function(t){e.pubsub.off(t)}))}}]),e}(),Ue=function(){function e(){Object(u.a)(this,e),this.sendQueue=void 0,this.messageListeners=void 0,this.allListeners=void 0,this.sendQueue=[],this.messageListeners=new Map,this.allListeners=new Map}return Object(c.a)(e,[{key:"sendMessages",value:function(){var e=this,t=this.sendQueue;this.sendQueue=[],t.forEach((function(t){var n=e.messageListeners.get(t.id);n&&n.listeners.forEach((function(e){try{e.handler(t.payload)}catch(n){console.error("ERROR",n)}}))}))}},{key:"processQueue",value:function(){var e=this;0!==this.sendQueue.length&&window.setTimeout((function(){e.sendMessages()}),1e3/60)}},{key:"send",value:function(e,t){var n={id:e,payload:t};this.sendQueue.push(n),this.processQueue()}},{key:"on",value:function(e,t){var n=this.messageListeners.get(e);n||(n={listeners:[]},this.messageListeners.set(e,n));var r=Ie.a.v4(),a={id:r,messageID:e,handler:t};return n.listeners.push(a),this.allListeners.set(r,a),r}},{key:"off",value:function(e){var t=this.allListeners.get(e);if(t){var n=this.messageListeners.get(t.messageID);n&&(n.listeners=n.listeners.filter((function(e){return e.id!==t.id})))}}}]),e}();!function(e){e[e.STARTED=0]="STARTED",e[e.POLLING=1]="POLLING",e[e.WAITING=2]="WAITING",e[e.PAUSED=3]="PAUSED",e[e.STOPPED=4]="STOPPED",e[e.ERROR=5]="ERROR"}(Oe||(Oe={}));var Pe=function(){function e(t){Object(u.a)(this,e),this.params=void 0,this.statusTimer=void 0,this.statusCount=void 0,this.watchStartAt=void 0,this.status=void 0,this.error=void 0,this.watcherTimer=void 0,this.waitTimer=void 0,this.pubsubProxy=void 0,this.params=t,this.statusTimer=null,this.statusCount=0,this.watchStartAt=0,this.status=Oe.STOPPED,this.watcherTimer=null,this.waitTimer=null,this.pubsubProxy=new je(this.params.pubsub),this.error=""}return Object(c.a)(e,[{key:"stop",value:function(){this.pubsubProxy.off()}},{key:"pause",value:function(){this.status=Oe.PAUSED,this.waitTimer&&window.clearInterval(this.waitTimer),this.statusTimer&&window.clearInterval(this.statusTimer),this.watcherTimer&&window.clearTimeout(this.watcherTimer),this.statusCount=0,this.updateOnProgress()}},{key:"play",value:function(){this.startWaiting()}},{key:"startWatching",value:function(){var e=this;this.watchStartAt=Date.now(),this.status=Oe.STARTED;var t=function(){var t=Date.now()-e.watchStartAt;if(t>1e4)return e.status=Oe.ERROR,e.error="Polling took too long (".concat(t,"ms)"),void e.stopPolling();switch(e.status){case Oe.STARTED:case Oe.POLLING:return void n();case Oe.WAITING:e.watcherTimer&&window.clearTimeout(e.watcherTimer),e.status=Oe.WAITING,e.startWaiting();break;case Oe.STOPPED:n();break;case Oe.PAUSED:console.warn("unexpected state PAUSED");break;case Oe.ERROR:console.warn("unexpected state ERROR")}},n=function(){e.watcherTimer=window.setTimeout(t,e.params.watchInterval)};n()}},{key:"startWaiting",value:function(){var e=this;this.status=Oe.WAITING;var t=function(){e.statusTimer=window.setInterval((function(){e.statusCount+=1,e.updateOnProgress()}),e.params.pollInterval/e.params.progressSteps)};e.waitTimer=window.setTimeout(e.runPoll.bind(e),e.params.pollInterval),e.statusCount=0,t()}},{key:"runPoll",value:function(){this.statusTimer&&window.clearInterval(this.statusTimer),this.params.onPoll(),this.statusCount=0,this.startWatching()}},{key:"startListeningForPollingEvent",value:function(){var e=this;this.pubsubProxy.on("searching",(function(t){if(t.is)switch(e.status){case Oe.STARTED:e.status=Oe.POLLING;break;case Oe.POLLING:break;case Oe.WAITING:e.pause();break;case Oe.STOPPED:case Oe.PAUSED:case Oe.ERROR:}else switch(e.status){case Oe.STARTED:break;case Oe.POLLING:e.status=Oe.WAITING;break;case Oe.WAITING:case Oe.STOPPED:break;case Oe.PAUSED:e.play();break;case Oe.ERROR:}}))}},{key:"stopListeningForPollingEvent",value:function(){this.pubsubProxy.off()}},{key:"startPolling",value:function(){this.startListeningForPollingEvent(),this.runPoll()}},{key:"updateOnProgress",value:function(){this.params.onProgress(100*this.statusCount/this.params.progressSteps)}},{key:"stopPolling",value:function(){this.waitTimer&&window.clearInterval(this.waitTimer),this.statusTimer&&window.clearInterval(this.statusTimer),this.watcherTimer&&window.clearTimeout(this.watcherTimer),this.statusCount=0,this.updateOnProgress(),this.stopListeningForPollingEvent()}}]),e}(),Le=1e4,xe=100,Me=100,Je=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).monitoringTimer=void 0,n.monitoringStatusTimer=void 0,n.pollWatcherTimer=void 0,n.searchListenerID=void 0,n.pubsubProxy=void 0,n.poller=void 0,n.monitoringTimer=null,n.monitoringStatusTimer=null,n.pollWatcherTimer=null,n.searchListenerID=null,n.pubsubProxy=new je(n.props.pubsub),n.poller=new Pe({onPoll:n.props.onPoll,onProgress:n.onProgress.bind(Object(Ne.a)(n)),pubsub:n.props.pubsub,pollInterval:Le,progressSteps:xe,watchInterval:Me}),n.state={isMonitoring:!1,pollWaitProgress:0,isPollingInitiated:!1,pollingStartedAt:0,isPolling:!1,isOpen:n.props.startOpen},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onProgress",value:function(e){this.setState({pollWaitProgress:e})}},{key:"componentDidMount",value:function(){var e=this;this.props.startPolling&&this.startMonitoring(),this.pubsubProxy.on("searching",(function(t){t.is?e.setState({isPolling:!0}):e.setState({isPolling:!1})}))}},{key:"componentWillUnmount",value:function(){this.stopMonitoring(),this.poller.stop(),this.pubsubProxy.off()}},{key:"componentDidUpdate",value:function(){}},{key:"startMonitoring",value:function(){this.setState({isMonitoring:!0}),this.poller.startPolling()}},{key:"stopMonitoring",value:function(){this.poller.stopPolling(),this.setState({isMonitoring:!1})}},{key:"toggleMonitoring",value:function(){this.state.isMonitoring?this.stopMonitoring():this.startMonitoring()}},{key:"onToggleOpen",value:function(e){this.setState({isOpen:e})}},{key:"render",value:function(){if(!this.props.showControls)return null;var e,t,n,r="Start Polling",i="default",o=a.createElement(q.a,{defaultChecked:this.state.isOpen,checkedChildren:"hide monitor",unCheckedChildren:"show monitor",onChange:this.onToggleOpen.bind(this)});return this.state.isMonitoring&&(r="Stop Polling",i="danger",e=this.state.isPolling?a.createElement("span",null," ",a.createElement(Te.a,{type:"circle",percent:100,width:30,showInfo:!1,strokeWidth:30,strokeColor:"orange"})):a.createElement("span",null," ",a.createElement(Te.a,{type:"circle",percent:this.state.pollWaitProgress,width:30,strokeWidth:30,showInfo:!1}))),t=this.state.isMonitoring?"Polling is running, with an interval of ".concat(Le,"ms and ").concat(xe," update steps."):"Polling is currently stopped.",this.state.isOpen&&(n=a.createElement(G.a,{title:t},a.createElement(X.a,{onClick:this.toggleMonitoring.bind(this),type:i,size:"small",style:{fontSize:"80%"}},r),e)),a.createElement("span",null,o," ",n)}}]),t}(a.Component),Fe=[{label:"Queued",value:"queued"},{label:"Running",value:"running"},{label:"Canceled",value:"canceled"},{label:"Success",value:"success"},{label:"Error",value:"error"}];var He=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).currentQuery=void 0,n.pubsub=void 0,n.currentQuery="",n.pubsub=new Ue,n.state={showDates:!1,currentJobStatusFilter:["queued","running","canceled","success","error"],timeRange:{kind:"preset",preset:t.defaultTimeRange},isFilterOpen:!1,selectedJob:null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.doSearch(!0)}},{key:"componentDidUpdate",value:function(){this.props.searchState===N.SEARCHING?this.pubsub.send("searching",{is:!0}):this.pubsub.send("searching",{is:!1})}},{key:"onChangeTimeRange",value:function(e){var t=this;"customRange"!==e?this.setState({showDates:!1,timeRange:{kind:"preset",preset:e}},(function(){t.doSearch(!0)})):this.setState({showDates:!0,timeRange:{kind:"literal",start:Date.now(),end:Date.now()}})}},{key:"onChangeQuery",value:function(e){this.currentQuery=e.target.value}},{key:"onSubmit",value:function(e){e.preventDefault(),this.doSearch(!0)}},{key:"doSearch",value:function(e){if("undefined"!==typeof this.currentQuery){var t=function(e){var t=[];return e.forEach((function(e){switch(e){case"queued":t.push(T.QUEUED);break;case"running":t.push(T.RUNNING);break;case"canceled":t.push(T.CANCELED_QUEUED),t.push(T.CANCELED_RUNNING);break;case"success":t.push(T.FINISHED);break;case"error":t.push(T.ERRORED)}})),t}(this.state.currentJobStatusFilter),n={query:this.currentQuery,timeRange:this.state.timeRange,jobStatus:t,forceSearch:e};return this.pubsub.send("search",{}),this.props.search(n),!1}}},{key:"onRangeFromChange",value:function(e,t){if(null!==e){var n,r=this.state.timeRange;switch(r.kind){case"preset":n={kind:"literal",start:e.valueOf(),end:1/0};break;case"literal":n={kind:"literal",start:e.valueOf(),end:r.end};break;default:return}this.setState({timeRange:n})}else this.setState({timeRange:{kind:"preset",preset:"lastHour"}})}},{key:"onRangeToChange",value:function(e,t){if(null!==e){var n,r=this.state.timeRange;switch(r.kind){case"preset":n={kind:"literal",start:1/0,end:e.valueOf()};break;case"literal":n={kind:"literal",start:r.start,end:e.valueOf()};break;default:return}this.setState({timeRange:n})}else this.setState({timeRange:{kind:"preset",preset:"lastHour"}})}},{key:"renderJobAction",value:function(e){var t=this;switch(e.status){case T.QUEUED:case T.RUNNING:return i.a.createElement(Z.a,{title:"Cancel this job?",onConfirm:function(){t.props.cancelJob(e.id)},okText:"Yes",cancelText:"No"},i.a.createElement(X.a,{icon:"close",type:"danger"}));default:return}}},{key:"renderSearchInput",value:function(){var e,n=this;if(this.state.showDates){var r=this.state.timeRange;"literal"===r.kind&&(e=i.a.createElement(i.a.Fragment,null,i.a.createElement(Y.a.Item,{label:"From"},i.a.createElement(K.a,{showTime:!0,allowClear:!1,value:ee()(r.start),onChange:this.onRangeFromChange.bind(this)})),i.a.createElement(Y.a.Item,{label:"To"},i.a.createElement(K.a,{showTime:!0,allowClear:!1,value:ee()(r.end),onChange:this.onRangeToChange.bind(this)}))))}return i.a.createElement(Y.a,{layout:"inline",onSubmit:this.onSubmit.bind(this)},i.a.createElement(Y.a.Item,null,i.a.createElement(B.a,{defaultValue:this.currentQuery,placeholder:"Search jobs",style:{width:"15em"},onChange:this.onChangeQuery.bind(this)})),i.a.createElement(Y.a.Item,{label:"TimeRange"}),i.a.createElement(Y.a.Item,null,i.a.createElement(W.a,{defaultValue:t.defaultTimeRange,onChange:this.onChangeTimeRange.bind(this),dropdownMatchSelectWidth:!0,style:{width:"11em"}},i.a.createElement(W.a.Option,{value:"lastHour"},"Previous Hour"),i.a.createElement(W.a.Option,{value:"last48Hours"},"Previous 48 Hours"),i.a.createElement(W.a.Option,{value:"lastWeek"},"Previous Week"),i.a.createElement(W.a.Option,{value:"lastMonth"},"Previous Month"),i.a.createElement(W.a.Option,{value:"customRange"},"Custom Range"))),e,i.a.createElement(Y.a.Item,null,i.a.createElement(X.a,{icon:"search",type:"primary",htmlType:"submit"})),i.a.createElement(Y.a.Item,null,i.a.createElement(q.a,{checkedChildren:"hide filters",unCheckedChildren:"show filters",onChange:this.onToggleFilterArea.bind(this)})),i.a.createElement(Y.a.Item,null,i.a.createElement(Je,{onPoll:function(){n.doSearch(!0)},pubsub:this.pubsub,startPolling:!0,isPollerRunning:this.props.searchState===N.SEARCHING,showControls:this.props.showMonitoringControls,startOpen:!0})))}},{key:"onToggleFilterArea",value:function(e){this.setState({isFilterOpen:e})}},{key:"onFilterChange",value:function(e){var t=this,n=e;this.setState({currentJobStatusFilter:n},(function(){t.doSearch(!1)}))}},{key:"onChangeJobStatusAny",value:function(e){var t=this;e.target.checked&&this.setState({currentJobStatusFilter:["queued","running","canceled","success","error"]},(function(){t.doSearch(!1)}))}},{key:"onClickAny",value:function(){var e=this;this.setState({currentJobStatusFilter:["queued","running","canceled","success","error"]},(function(){e.doSearch(!1)}))}},{key:"onClickFinished",value:function(){var e=this;this.setState({currentJobStatusFilter:["canceled","success","error"]},(function(){e.doSearch(!1)}))}},{key:"onClickActive",value:function(){var e=this;this.setState({currentJobStatusFilter:["queued","running"]},(function(){e.doSearch(!1)}))}},{key:"renderFilterInput",value:function(){var e=Fe;return i.a.createElement("div",{className:"UserJobs-filterArea"},i.a.createElement("span",{style:{color:"gray",fontWeight:"bold",marginRight:"10px"}},"Filter by Job Status"),i.a.createElement(X.a,{size:"small",onClick:this.onClickAny.bind(this)},i.a.createElement("i",null,"Any"))," ",i.a.createElement(X.a,{size:"small",onClick:this.onClickActive.bind(this)},i.a.createElement("i",null,"Active"))," ",i.a.createElement(X.a,{size:"small",onClick:this.onClickFinished.bind(this),style:{marginRight:"10px"}},i.a.createElement("i",null,"Finished")),i.a.createElement(V.a.Group,{options:e,onChange:this.onFilterChange.bind(this),value:this.state.currentJobStatusFilter}))}},{key:"renderControlBar",value:function(){var e,t={margin:"10px 10px 10px 0"};return this.state.isFilterOpen||(t.display="none"),this.state.isFilterOpen&&(e=i.a.createElement("div",{className:"Row",style:t},this.renderFilterInput())),i.a.createElement("div",{className:"Col"},i.a.createElement("div",{className:"Row"},this.renderSearchInput()),e)}},{key:"onClickDetail",value:function(e){this.setState({selectedJob:e})}},{key:"onCloseModal",value:function(){this.setState({selectedJob:null})}},{key:"renderJobDetail",value:function(){if(this.state.selectedJob){var e=i.a.createElement(X.a,{key:"cancel",onClick:this.onCloseModal.bind(this)},"Close"),t=i.a.createElement("span",null,"Detail for Job ",i.a.createElement("span",{style:{fontFamily:"monospace",fontWeight:"bold"}},this.state.selectedJob.id));return i.a.createElement(Q.a,{className:"FullScreenModal",title:t,onCancel:this.onCloseModal.bind(this),visible:!0,footer:e},i.a.createElement(Ce,{jobID:this.state.selectedJob.id}))}}},{key:"renderJobsTable",value:function(){var e=this,t=this.props.searchState===N.SEARCHING;return i.a.createElement(z.a,{size:"small",className:"UserJobs-table ScrollingFlexTable",dataSource:this.props.jobs,loading:t,rowKey:function(e){return e.id},pagination:!1,scroll:{y:"100%"}},i.a.createElement(z.a.Column,{title:"ID",dataIndex:"id",key:"id",width:"8%",render:function(t,n){var r=t;return i.a.createElement(G.a,{title:r},i.a.createElement("a",{href:"https://example.com",onClick:function(t){t.preventDefault(),e.onClickDetail(n)}},t))},sorter:function(e,t){return e.id.localeCompare(t.id)}}),i.a.createElement(z.a.Column,{title:"User",dataIndex:"username",key:"username",width:"10%",render:function(e){return i.a.createElement("a",{href:"#people/".concat(e),target:"_parent"},e)},sorter:function(e,t){return e.username.localeCompare(t.username)}}),i.a.createElement(z.a.Column,{title:"Narrative",dataIndex:"narrativeTitle",key:"narrativeTitle",width:"17%",render:function(e,t){if(!e||!t.narrativeID)return"n/a";var n=["/narrative",t.narrativeID].join("/");return i.a.createElement(G.a,{title:e},i.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},e))},sorter:function(e,t){return e.narrativeTitle?t.narrativeTitle?e.narrativeTitle.localeCompare(t.narrativeTitle):1:t.narrativeTitle?-1:0}}),i.a.createElement(z.a.Column,{title:"App",dataIndex:"appTitle",key:"appTitle",width:"18%",render:function(e,t){if(!e)return"n/a";var n="/#catalog/apps/"+t.appID;return i.a.createElement(G.a,{title:e},i.a.createElement("a",{href:n,target:"_parent"},e))},sorter:function(e,t){return e.appTitle?t.appTitle?e.appTitle.localeCompare(t.appTitle):1:t.appTitle?-1:0}}),i.a.createElement(z.a.Column,{title:"Submitted",dataIndex:"queuedAt",key:"queuedAt",width:"8%",render:function(e,t){return e?i.a.createElement(f.NiceRelativeTime,{time:new Date(e)}):i.a.createElement("span",null,"** empty **")},defaultSortOrder:"descend",sorter:function(e,t){return null===e.queuedAt?null===t.queuedAt?0:-1:null===t.queuedAt?1:e.queuedAt-t.queuedAt}}),i.a.createElement(z.a.Column,{title:"Queued",dataIndex:"queuedElapsed",key:"queuedElapsed",width:"8%",render:function(e,t){switch(t.status){case T.QUEUED:return i.a.createElement(f.NiceElapsedTime,{from:t.queuedAt,precision:2,useClock:!0});case T.CANCELED_QUEUED:return i.a.createElement(f.NiceElapsedTime,{from:t.queuedAt,to:t.finishAt,precision:2});default:return i.a.createElement(f.NiceElapsedTime,{from:t.queuedAt,to:t.runAt,precision:2})}}}),i.a.createElement(z.a.Column,{title:"Run",key:"runElapsed",width:"10%",render:function(e,t){switch(t.status){case T.QUEUED:case T.CANCELED_QUEUED:return"-";case T.RUNNING:return i.a.createElement(f.NiceElapsedTime,{from:t.runAt,precision:2,useClock:!0});case T.FINISHED:case T.CANCELED_RUNNING:case T.ERRORED:return i.a.createElement(f.NiceElapsedTime,{from:t.runAt,to:t.finishAt,precision:2})}}}),i.a.createElement(z.a.Column,{title:"Status",dataIndex:"status",key:"status",width:"8%",render:function(e,t){return i.a.createElement(ae,{job:t})},sorter:function(e,t){return e.status===t.status?0:e.status===T.QUEUED?-1:e.status===T.RUNNING?t.status===T.QUEUED?1:-1:e.status===T.FINISHED?t.status===T.QUEUED||t.status===T.RUNNING?1:-1:e.status===T.ERRORED&&(t.status===T.CANCELED_QUEUED||t.status===T.CANCELED_RUNNING)?-1:1}}),i.a.createElement(z.a.Column,{title:"Server",dataIndex:"clientGroups",key:"clientGroups",width:"8%",render:function(e){return e.join(",")},sorter:function(e,t){return e.clientGroups.join(",").localeCompare(t.clientGroups.join(","))}}),i.a.createElement(z.a.Column,{title:"Cancel",dataIndex:"action",key:"action",width:"5%",render:function(t,n){return e.renderJobAction(n)}}))}},{key:"render",value:function(){return i.a.createElement("div",{"data-k-b-testhook-component":"UserJobs",className:"UserJobs"},i.a.createElement("div",null,this.renderControlBar()),this.renderJobsTable(),this.renderJobDetail())}}]),t}(i.a.Component);He.defaultTimeRange="lastWeek";var ze=function(){function e(){Object(u.a)(this,e),this.pendingTasks=void 0,this.isCanceled=void 0,this.pendingTasks=new Map,this.isCanceled=!1}return Object(c.a)(e,[{key:"newID",value:function(){return Ie.a.v4()}},{key:"cancel",value:function(e){e.isCanceled=!0,this.pendingTasks.delete(e.id)}},{key:"cancelPending",value:function(){var e=this;this.pendingTasks.forEach((function(t,n){e.cancel(t)}))}},{key:"done",value:function(e){this.pendingTasks.delete(e.id)}},{key:"spawn",value:function(e){return this.cancelPending(),this.request(e)}}]),e}();function Ge(){return{type:r.USER_JOBS_SEARCH_START}}function Qe(e,t,n,a){return{type:r.USER_JOBS_SEARCH_SUCCESS,searchExpression:a,rawJobs:e,jobs:t,jobsFetchedAt:n}}function Ve(e){return{type:r.USER_JOBS_SEARCH_ERROR,error:e}}var qe=new(function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"request",value:function(e){var t=e.token,n=e.serviceWizardURL,r=e.from,a=e.to,i=new Se({url:n,token:t}).getJobs({epoch_range:[r,a],user_ids:[]}).then((function(e){return e.job_states.map((function(e){return we(e,"UNKNOWN")}))})),o={id:this.newID(),promise:i,isCanceled:!1};return this.pendingTasks.set(o.id,o),o}}]),t}(ze));function We(e){return{type:r.USER_JOBS_CANCEL_ERROR,error:e}}var Be=Object(M.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.views.userJobsView,a=r.searchState,i=r.jobs;if(!n)throw new Error("Not authorized!");return{jobs:i,searchState:a,showMonitoringControls:!0}}),(function(e,t){return{search:function(t){e(function(e){return function(){var t=Object(ue.a)(se.a.mark((function t(n,r){var a,i,o,s,u,c,l,h,d,p,f,m,v,E;return se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n(Ge()),a=r(),i=a.auth.userAuthorization,o=a.app.config.services.ServiceWizard.url,i){t.next=5;break}return n(Ve({message:"Not authorized",code:"unauthorized"})),t.abrupt("return");case 5:if(s=r(),u=s.views.userJobsView,c=u.jobsFetchedAt,l=u.rawJobs,h=e.query.split(/\s+/).map((function(e){return new RegExp(e,"i")})),d=ke(e.timeRange),p=Object(ie.a)(d,2),f=p[0],m=p[1],c&&!e.forceSearch){t.next=18;break}return v=qe.spawn({token:i.token,serviceWizardURL:o,from:f,to:m}),t.next=12,v.promise;case 12:if(l=t.sent,!v.isCanceled){t.next=15;break}return t.abrupt("return");case 15:c=(new Date).getTime(),qe.done(v),c=(new Date).getTime();case 18:E=l.filter((function(t){return h.every((function(e){return e.test(t.appTitle)||e.test(t.narrativeTitle)||e.test(t.id)||e.test(t.username)}))&&_e(t,e.jobStatus)})),n(Qe(l,E,c,e));case 20:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))},cancelJob:function(t){e(function(e){return function(){var t=Object(ue.a)(se.a.mark((function t(n,a){var i,o,s;return se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:r.USER_JOBS_CANCEL_START}),i=a(),o=i.auth.userAuthorization,s=i.app.config.services.NarrativeJobService.url,o){t.next=5;break}return n(We({message:"no authorization",code:"no-authorization"})),t.abrupt("return");case 5:new ye.NarrativeJobServiceClient({url:s,token:o.token,module:"NarrativeJobService"}).cancelJob({job_id:e}).then((function(){n({type:r.USER_JOBS_CANCEL_SUCCESS}),n(function(){var e=Object(ue.a)(se.a.mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d,p,f,m;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(Ge()),r=n(),a=r.auth.userAuthorization){e.next=5;break}return t(Ve({message:"Not authorized",code:"unauthorized"})),e.abrupt("return");case 5:if(i=n(),o=i.app.config.services.ServiceWizard.url,s=i.views.userJobsView.searchExpression){e.next=9;break}return Ve({message:"No search expression",code:"nosearchexpression"}),e.abrupt("return");case 9:return u=s.query.split(/\s+/).map((function(e){return new RegExp(e,"i")})),c=ke(s.timeRange),l=Object(ie.a)(c,2),h=l[0],d=l[1],p=qe.spawn({token:a.token,serviceWizardURL:o,from:h,to:d}),e.next=14,p.promise;case 14:if(f=e.sent,!p.isCanceled){e.next=17;break}return e.abrupt("return");case 17:qe.done(p),m=f.filter((function(e){return u.every((function(t){return t.test(e.appTitle)||t.test(e.narrativeTitle)}))&&_e(e,s.jobStatus)})),t(Qe(f,m,Date.now(),s));case 20:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())})).catch((function(e){console.error("error canceling job",e),n(We({message:"error canceling job: "+e.message,code:"error-canceling"}))}));case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))}}}))(He),Ye=(n(1146),[{label:"Queued",value:"queued"},{label:"Running",value:"running"},{label:"Canceled",value:"canceled"},{label:"Success",value:"success"},{label:"Error",value:"error"}]);var Ke=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).currentQuery=void 0,n.pubsub=void 0,n.currentQuery="",n.pubsub=new Ue,n.state={showDates:!1,currentJobStatusFilter:["queued","running","canceled","success","error"],timeRange:{kind:"preset",preset:t.defaultTimeRangePreset},isFilterOpen:!1,selectedJob:null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.doSearch(!0)}},{key:"componentDidUpdate",value:function(){this.props.searchState===N.SEARCHING?this.pubsub.send("searching",{is:!0}):this.pubsub.send("searching",{is:!1})}},{key:"onChangeTimeRange",value:function(e){var t=this;"customRange"!==e?this.setState({showDates:!1,timeRange:{kind:"preset",preset:e}},(function(){t.doSearch(!0)})):this.setState({showDates:!0,timeRange:{kind:"literal",start:Date.now(),end:Date.now()}})}},{key:"onChangeQuery",value:function(e){this.currentQuery=e.target.value}},{key:"onSubmit",value:function(e){e.preventDefault(),this.doSearch(!0)}},{key:"doSearch",value:function(e){if("undefined"!==typeof this.currentQuery){var t=function(e){var t=[];return e.forEach((function(e){switch(e){case"queued":t.push(T.QUEUED);break;case"running":t.push(T.RUNNING);break;case"canceled":t.push(T.CANCELED_QUEUED),t.push(T.CANCELED_RUNNING);break;case"success":t.push(T.FINISHED);break;case"error":t.push(T.ERRORED)}})),t}(this.state.currentJobStatusFilter),n={query:this.currentQuery,timeRange:this.state.timeRange,jobStatus:t,forceSearch:e};return this.pubsub.send("search",{}),this.props.search(n),!1}}},{key:"onRangeFromChange",value:function(e,t){if(null!==e){var n,r=this.state.timeRange;switch(r.kind){case"preset":n={kind:"literal",start:e.valueOf(),end:1/0};break;case"literal":n={kind:"literal",start:e.valueOf(),end:r.end};break;default:return}this.setState({timeRange:n})}else this.setState({timeRange:{kind:"preset",preset:"lastHour"}})}},{key:"onRangeToChange",value:function(e,t){if(null!==e){var n,r=this.state.timeRange;switch(r.kind){case"preset":n={kind:"literal",start:1/0,end:e.valueOf()};break;case"literal":n={kind:"literal",start:r.start,end:e.valueOf()};break;default:return}this.setState({timeRange:n})}else this.setState({timeRange:{kind:"preset",preset:"lastHour"}})}},{key:"renderSearchInput",value:function(){var e,n=this;if(this.state.showDates){var r=this.state.timeRange;"literal"===r.kind&&(e=i.a.createElement(i.a.Fragment,null,i.a.createElement(Y.a.Item,{label:"From"},i.a.createElement(K.a,{showTime:!0,allowClear:!1,value:ee()(r.start),onChange:this.onRangeFromChange.bind(this)})),i.a.createElement(Y.a.Item,{label:"To"},i.a.createElement(K.a,{showTime:!0,allowClear:!1,value:ee()(r.end),onChange:this.onRangeToChange.bind(this)}))))}return i.a.createElement(Y.a,{layout:"inline",onSubmit:this.onSubmit.bind(this)},i.a.createElement(Y.a.Item,null,i.a.createElement(B.a,{defaultValue:this.currentQuery,placeholder:"Search jobs",style:{width:"15em"},onChange:this.onChangeQuery.bind(this)})),i.a.createElement(Y.a.Item,{label:"TimeRange"}),i.a.createElement(Y.a.Item,null,i.a.createElement(W.a,{defaultValue:t.defaultTimeRangePreset,onChange:this.onChangeTimeRange.bind(this),dropdownMatchSelectWidth:!0,style:{width:"11em"}},i.a.createElement(W.a.Option,{value:"lastHour"},"Previous Hour"),i.a.createElement(W.a.Option,{value:"last48Hours"},"Previous 48 Hours"),i.a.createElement(W.a.Option,{value:"lastWeek"},"Previous Week"),i.a.createElement(W.a.Option,{value:"lastMonth"},"Previous Month"),i.a.createElement(W.a.Option,{value:"customRange"},"Custom Range"))),e,i.a.createElement(Y.a.Item,null,i.a.createElement(X.a,{icon:"search",type:"primary",htmlType:"submit"})),i.a.createElement(Y.a.Item,null,i.a.createElement(q.a,{checkedChildren:"hide filters",unCheckedChildren:"show filters",onChange:this.onToggleFilterArea.bind(this)})),i.a.createElement(Y.a.Item,null,i.a.createElement(Je,{onPoll:function(){n.doSearch(!0)},pubsub:this.pubsub,isPollerRunning:this.props.searchState===N.SEARCHING,startPolling:!1,showControls:this.props.showMonitoringControls,startOpen:!1})))}},{key:"onToggleFilterArea",value:function(e){this.setState({isFilterOpen:e})}},{key:"onFilterChange",value:function(e){var t=this,n=e;this.setState({currentJobStatusFilter:n},(function(){t.doSearch(!1)}))}},{key:"onChangeJobStatusAny",value:function(e){var t=this;e.target.checked&&this.setState({currentJobStatusFilter:["queued","running","canceled","success","error"]},(function(){t.doSearch(!1)}))}},{key:"onClickAny",value:function(){var e=this;this.setState({currentJobStatusFilter:["queued","running","canceled","success","error"]},(function(){e.doSearch(!1)}))}},{key:"onClickFinished",value:function(){var e=this;this.setState({currentJobStatusFilter:["canceled","success","error"]},(function(){e.doSearch(!1)}))}},{key:"onClickActive",value:function(){var e=this;this.setState({currentJobStatusFilter:["queued","running"]},(function(){e.doSearch(!1)}))}},{key:"renderFilterInput",value:function(){var e=Ye;return i.a.createElement("div",{className:"MyJobs-filterArea"},i.a.createElement("span",{style:{color:"gray",fontWeight:"bold",marginRight:"10px"}},"Filter by Job Status"),i.a.createElement(X.a,{size:"small",type:"link",onClick:this.onClickAny.bind(this),"data-k-b-testhook-button":"any"},i.a.createElement("i",null,"Any"))," ",i.a.createElement(X.a,{size:"small",type:"link",onClick:this.onClickActive.bind(this),"data-k-b-testhook-button":"active"},i.a.createElement("i",null,"Active"))," ",i.a.createElement(X.a,{size:"small",type:"link",onClick:this.onClickFinished.bind(this),style:{marginRight:"10px"},"data-k-b-testhook-button":"finished"},i.a.createElement("i",null,"Finished")),i.a.createElement(V.a.Group,{options:e,onChange:this.onFilterChange.bind(this),value:this.state.currentJobStatusFilter}))}},{key:"renderControlBar",value:function(){var e,t={margin:"10px 10px 10px 0"};return this.state.isFilterOpen||(t.display="none"),this.state.isFilterOpen&&(e=i.a.createElement("div",{className:"Row",style:t},this.renderFilterInput())),i.a.createElement("div",{className:"Col"},i.a.createElement("div",{className:"Row"},this.renderSearchInput()),e)}},{key:"onJobCancel",value:function(e){this.props.cancelJob(e.id)}},{key:"renderJobAction",value:function(e){var t=this;switch(e.status){case T.QUEUED:case T.RUNNING:return i.a.createElement(Z.a,{title:"Cancel this job?",onConfirm:function(){t.onJobCancel(e)},okText:"Yes",cancelText:"No"},i.a.createElement(X.a,{icon:"close",type:"danger",size:"small","data-k-b-testhook-button":"cancel"}));default:return}}},{key:"onClickDetail",value:function(e){this.setState({selectedJob:e})}},{key:"onCloseModal",value:function(){this.setState({selectedJob:null})}},{key:"renderJobsTable",value:function(){var e=this,t=this.props.searchState===N.SEARCHING;return i.a.createElement(z.a,{size:"small",className:"MyJobs-table ScrollingFlexTable",dataSource:this.props.jobs,loading:t,rowKey:function(e){return e.id},pagination:!1,scroll:{y:"100%"}},i.a.createElement(z.a.Column,{title:"ID",dataIndex:"id",key:"id",width:"10%",render:function(t,n){var r=t;return i.a.createElement(G.a,{title:r},i.a.createElement("a",{href:"https://example.com",onClick:function(t){t.preventDefault(),e.onClickDetail(n)}},t))},sorter:function(e,t){return e.id.localeCompare(t.id)}}),i.a.createElement(z.a.Column,{title:"Narrative",dataIndex:"narrativeTitle",key:"narrativeTitle",width:"17%",render:function(e,t){return e&&t.narrativeID?i.a.createElement(G.a,{title:e},i.a.createElement("a",{href:"/narrative/".concat(t.narrativeID),target:"_blank",rel:"noopener noreferrer"},e)):"n/a"},sorter:function(e,t){return e.narrativeTitle.localeCompare(t.narrativeTitle)}}),i.a.createElement(z.a.Column,{title:"App",dataIndex:"appTitle",key:"appTitle",width:"20%",render:function(e,t){if(!e)return"n/a";var n="/#catalog/apps/"+t.appID;return i.a.createElement(G.a,{title:e},i.a.createElement("a",{href:n},e))},sorter:function(e,t){return e.appTitle.localeCompare(t.appTitle)}}),i.a.createElement(z.a.Column,{title:"Submitted",dataIndex:"queuedAt",key:"queuedAt",width:"10%",render:function(e,t){return e?i.a.createElement(f.NiceRelativeTime,{time:new Date(e)}):i.a.createElement("span",null,"** empty **")},defaultSortOrder:"descend",sorter:function(e,t){return null===e.queuedAt?null===t.queuedAt?0:-1:null===t.queuedAt?1:e.queuedAt-t.queuedAt}}),i.a.createElement(z.a.Column,{title:"Queued",dataIndex:"queuedElapsed",key:"queuedElapsed",width:"10%",render:function(e,t){switch(t.status){case T.QUEUED:return i.a.createElement(f.NiceElapsedTime,{from:t.queuedAt,precision:2,useClock:!0});case T.CANCELED_QUEUED:return i.a.createElement(f.NiceElapsedTime,{from:t.queuedAt,to:t.finishAt,precision:2});default:return i.a.createElement(f.NiceElapsedTime,{from:t.queuedAt,to:t.runAt,precision:2})}}}),i.a.createElement(z.a.Column,{title:"Run",key:"runElapsed",width:"10%",render:function(e,t){switch(t.status){case T.QUEUED:case T.CANCELED_QUEUED:return"-";case T.RUNNING:return i.a.createElement(f.NiceElapsedTime,{from:t.runAt,precision:2,useClock:!0});case T.FINISHED:case T.CANCELED_RUNNING:case T.ERRORED:return i.a.createElement(f.NiceElapsedTime,{from:t.runAt,to:t.finishAt,precision:2})}}}),i.a.createElement(z.a.Column,{title:"Status",dataIndex:"status",key:"status",width:"10%",render:function(e,t){return i.a.createElement(ae,{job:t})},sorter:function(e,t){return e.status===t.status?0:e.status===T.QUEUED?-1:e.status===T.RUNNING?t.status===T.QUEUED?1:-1:e.status===T.FINISHED?t.status===T.QUEUED||t.status===T.RUNNING?1:-1:e.status===T.ERRORED&&(t.status===T.CANCELED_QUEUED||t.status===T.CANCELED_RUNNING)?-1:1}}),i.a.createElement(z.a.Column,{title:"Server",dataIndex:"clientGroups",key:"clientGroups",width:"8%",render:function(e){return e.join(",")},sorter:function(e,t){return e.clientGroups.join(",").localeCompare(t.clientGroups.join(","))}}),i.a.createElement(z.a.Column,{title:"Cancel",dataIndex:"action",key:"action",width:"5%",render:function(t,n){return e.renderJobAction(n)}}))}},{key:"renderJobDetail",value:function(){if(this.state.selectedJob){var e=i.a.createElement(X.a,{key:"cancel",onClick:this.onCloseModal.bind(this)},"Close"),t=i.a.createElement("span",null,"Detail for Job ",i.a.createElement("span",{style:{fontFamily:"monospace",fontWeight:"bold"}},this.state.selectedJob.id));return i.a.createElement(Q.a,{className:"FullScreenModal",title:t,onCancel:this.onCloseModal.bind(this),visible:!0,footer:e},i.a.createElement(Ce,{jobID:this.state.selectedJob.id}))}}},{key:"render",value:function(){return i.a.createElement("div",{"data-k-b-testhook-component":"MyJobs",className:"MyJobs"},i.a.createElement("div",null,this.renderControlBar()),this.renderJobsTable(),this.renderJobDetail())}}]),t}(i.a.Component);function Ze(){return{type:r.MY_JOBS_SEARCH_START}}function Xe(e,t,n,a){return{type:r.MY_JOBS_SEARCH_SUCCESS,searchExpression:a,rawJobs:e,jobs:t,jobsFetchedAt:n}}function $e(e){return{type:r.MY_JOBS_SEARCH_ERROR,error:e}}Ke.defaultTimeRangePreset="lastWeek";var et=new(function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"request",value:function(e){var t=e.token,n=e.username,r=e.serviceWizardURL,a=e.from,i=e.to,o=new Se({url:r,token:t}).getJobs({epoch_range:[a,i],user_ids:[n]}).then((function(e){return e.job_states.map((function(e){return we(e,n)}))})),s={id:this.newID(),promise:o,isCanceled:!1};return this.pendingTasks.set(s.id,s),s}}]),t}(ze));function tt(){return function(){var e=Object(ue.a)(se.a.mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d,p,f,m;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(Ze()),r=n(),a=r.auth.userAuthorization){e.next=5;break}return t($e({message:"Not authorized",code:"unauthorized"})),e.abrupt("return");case 5:if(i=n(),o=i.app.config.services.ServiceWizard.url,s=i.views.myJobsView.searchExpression){e.next=9;break}return $e({message:"No search expression",code:"nosearchexpression"}),e.abrupt("return");case 9:return u=ke(s.timeRange),c=Object(ie.a)(u,2),l=c[0],h=c[1],d=s.query.split(/\s+/).map((function(e){return new RegExp(e,"i")})),p=et.spawn({token:a.token,username:a.username,serviceWizardURL:o,from:l,to:h}),e.next=14,p.promise;case 14:if(f=e.sent,!p.isCanceled){e.next=17;break}return e.abrupt("return");case 17:et.done(p),m=f.filter((function(e){return d.every((function(t){return t.test(e.appTitle)||t.test(e.narrativeTitle)}))&&_e(e,s.jobStatus)})),t(Xe(f,m,Date.now(),s));case 20:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}function nt(e){return{type:r.MY_JOBS_CANCEL_ERROR,error:e}}var rt=Object(M.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.views.myJobsView,a=r.searchState,i=r.jobs;if(!n)throw new Error("Not authorized!");return{jobs:i,searchState:a,showMonitoringControls:!0}}),(function(e,t){return{search:function(t){e(function(e){return function(){var t=Object(ue.a)(se.a.mark((function t(n,r){var a,i,o,s,u,c,l,h,d,p,f,m,v,E;return se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n(Ze()),a=r(),i=a.auth.userAuthorization){t.next=5;break}return n($e({message:"Not authorized",code:"unauthorized"})),t.abrupt("return");case 5:if(o=r(),s=o.app.config.services.ServiceWizard.url,u=o.views.myJobsView,c=u.jobsFetchedAt,l=u.rawJobs,h=e.query.split(/\s+/).map((function(e){return new RegExp(e,"i")})),d=ke(e.timeRange),p=Object(ie.a)(d,2),f=p[0],m=p[1],c&&!e.forceSearch){t.next=17;break}return v=et.spawn({token:i.token,username:i.username,serviceWizardURL:s,from:f,to:m}),t.next=12,v.promise;case 12:if(l=t.sent,!v.isCanceled){t.next=15;break}return t.abrupt("return");case 15:c=(new Date).getTime(),et.done(v);case 17:E=l.filter((function(t){return h.every((function(e){return e.test(t.appTitle)||e.test(t.narrativeTitle)}))&&_e(t,e.jobStatus)})),n(Xe(l,E,c,e));case 19:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))},cancelJob:function(t){e(function(e){return function(){var t=Object(ue.a)(se.a.mark((function t(n,a){var i,o,s;return se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:r.MY_JOBS_CANCEL_START}),i=a(),o=i.auth.userAuthorization,s=i.app.config.services.NarrativeJobService.url,o){t.next=5;break}return n(nt({message:"no authorization",code:"no-authorization"})),t.abrupt("return");case 5:new ye.NarrativeJobServiceClient({url:s,token:o.token,module:"NarrativeJobService"}).cancelJob({job_id:e}).then((function(){n({type:r.MY_JOBS_CANCEL_SUCCESS}),n(tt())})).catch((function(e){console.error("error canceling job",e),n(nt({message:"error canceling job: "+e.message,code:"error-canceling"}))}));case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))},refreshSearch:function(){e(tt())}}}))(Ke),at=(n(1147),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).currentQuery=void 0,n.currentQuery="",n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.onSearch({query:this.currentQuery})}},{key:"onSubmitSearch",value:function(e){e.preventDefault(),this.props.onSearch({query:this.currentQuery})}},{key:"onChangeQuery",value:function(e){this.currentQuery=e.target.value}},{key:"renderControlBar",value:function(){return i.a.createElement(Y.a,{layout:"inline",onSubmit:this.onSubmitSearch.bind(this)},i.a.createElement(Y.a.Item,null,i.a.createElement(B.a,{defaultValue:this.currentQuery,placeholder:"Search App Stats (leave empty for all)",style:{width:"20em"},onChange:this.onChangeQuery.bind(this)})),i.a.createElement(Y.a.Item,null,i.a.createElement(X.a,{icon:"search",type:"primary",htmlType:"submit"})))}},{key:"onTableChange",value:function(e,t,n){}},{key:"renderAppStatsTable",value:function(){return i.a.createElement(z.a,{dataSource:this.props.appStats,loading:this.props.searchState===N.SEARCHING,rowKey:function(e){return e.appId},pagination:!1,scroll:{y:"100%"},size:"small",className:"PreciseTable ScrollingFlexTable",onChange:this.onTableChange},i.a.createElement(z.a.Column,{title:"Module",dataIndex:"moduleId",key:"moduleId",width:"25%",render:function(e,t){return i.a.createElement(G.a,{title:t.moduleTitle},i.a.createElement("a",{href:"#catalog/module/".concat(e)},t.moduleTitle))},sorter:function(e,t){return e.moduleTitle.localeCompare(t.moduleTitle)},defaultSortOrder:"ascend"}),i.a.createElement(z.a.Column,{title:"Function",dataIndex:"functionId",key:"functionId",width:"25%",render:function(e,t){return i.a.createElement(G.a,{title:t.functionTitle},i.a.createElement("a",{href:"#catalog/apps/".concat(t.moduleId,"/").concat(t.functionId)},t.functionTitle))},sorter:function(e,t){return e.functionTitle.localeCompare(t.functionTitle)}}),i.a.createElement(z.a.Column,{title:"Runs",dataIndex:"runCount",key:"runCount",width:"5%",align:"right",render:function(e){return i.a.createElement("div",{className:"NumericColumn"},new Intl.NumberFormat("en-US",{useGrouping:!0}).format(e))},sorter:function(e,t){return e.runCount-t.runCount}}),i.a.createElement(z.a.Column,{title:"Errors",dataIndex:"errorCount",key:"errorCount",width:"5%",align:"right",render:function(e){return i.a.createElement("div",{className:"NumericColumn"},new Intl.NumberFormat("en-US",{useGrouping:!0}).format(e))},sorter:function(e,t){return e.errorCount-t.errorCount}}),i.a.createElement(z.a.Column,{title:"Success",dataIndex:"successRate",key:"successRate",width:"10%",render:function(e){return i.a.createElement(Te.a,{percent:100*e,format:function(t){return new Intl.NumberFormat("en-US",{style:"percent"}).format(e)}})},sorter:function(e,t){return e.successRate-t.successRate}}),i.a.createElement(z.a.Column,{title:"Avg Run",dataIndex:"averageRunTime",key:"averageRunTime",width:"10%",render:function(e){return i.a.createElement(f.NiceTimeDuration,{precision:2,duration:1e3*e})},sorter:function(e,t){return e.averageRunTime-t.averageRunTime}}),i.a.createElement(z.a.Column,{title:"Avg Queue",dataIndex:"averageQueueTime",key:"averageQueueTime",width:"10%",render:function(e){return i.a.createElement(f.NiceTimeDuration,{precision:2,duration:1e3*e})},sorter:function(e,t){return e.averageQueueTime-t.averageQueueTime}}),i.a.createElement(z.a.Column,{title:"Total Run",dataIndex:"totalRunTime",key:"totalRunTime",width:"10%",render:function(e){return i.a.createElement(f.NiceTimeDuration,{precision:2,duration:1e3*e})},sorter:function(e,t){return e.totalRunTime-t.totalRunTime}}))}},{key:"render",value:function(){return i.a.createElement("div",{className:"PublicAppStats"},this.renderControlBar(),this.renderAppStatsTable())}}]),t}(i.a.Component));function it(e,t){return e?t?e/t:null:t?0:null}function ot(e){return{type:r.PUBLIC_APP_STATS_SEARCH_ERROR,error:e}}var st=Object(M.connect)((function(e,t){var n=e.views.publicAppStatsView,r=n.appStats;return{searchState:n.searchState,appStats:r}}),(function(e,t){return{onSearch:function(t){e(function(e){return function(){var t=Object(ue.a)(se.a.mark((function t(n,a){var i,o,s,u,c,l,h,d;return se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:r.PUBLIC_APP_STATS_SEARCH_START}),i=a(),o=i.auth.userAuthorization,s=i.app.config.services.Catalog.url,o){t.next=5;break}return n(ot({message:"Not authorized",code:"unauthorized"})),t.abrupt("return");case 5:if(o){t.next=8;break}return n(ot({message:"Not authorized",code:"unauthorized"})),t.abrupt("return");case 8:return u=new ye.CatalogClient({module:"Catalog",token:o.token,url:s}),t.next=11,u.getExecAggrStats({});case 11:c=t.sent,l=c.map((function(e){var t=e.full_app_id.split("/"),n=Object(ie.a)(t,2),r=n[0],a=n[1];r&&a||console.warn("bad app!",e);var i,o,s=(i=e.number_of_calls-e.number_of_errors,o=e.number_of_calls,i?o?i/o:null:o?0:null),u=it(e.total_exec_time,e.number_of_calls),c=it(e.total_queue_time,e.number_of_calls);return{appId:e.full_app_id,moduleId:r,functionId:a||"",moduleTitle:r,functionTitle:a||"",runCount:e.number_of_calls,errorCount:e.number_of_errors,successRate:s,averageRunTime:u,averageQueueTime:c,totalRunTime:e.total_queue_time}})),h=e.query.split(/\s+/).map((function(e){return new RegExp(e,"i")})),d=l.filter((function(e){return h.every((function(t){return t.test(e.moduleTitle)||t.test(e.moduleId)||t.test(e.functionTitle)||t.test(e.functionId)}))})),n((p=d,{type:r.PUBLIC_APP_STATS_SEARCH_SUCCESS,appStats:p}));case 16:case"end":return t.stop()}var p}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))}}}))(at),ut=(n(1148),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).currentQuery=void 0,n.currentQuery={query:""},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.search(this.currentQuery)}},{key:"onSubmitSearch",value:function(e){e.preventDefault(),this.props.search(this.currentQuery)}},{key:"onChangeQuery",value:function(e){this.currentQuery.query=e.target.value}},{key:"renderControlBar",value:function(){return i.a.createElement(Y.a,{layout:"inline",onSubmit:this.onSubmitSearch.bind(this)},i.a.createElement(Y.a.Item,null,i.a.createElement(B.a,{defaultValue:this.currentQuery.query,placeholder:"Search (leave empty for all)",style:{width:"20em"},onChange:this.onChangeQuery.bind(this)})),i.a.createElement(Y.a.Item,null,i.a.createElement(X.a,{icon:"search",type:"primary",htmlType:"submit"})))}},{key:"renderTable",value:function(){return i.a.createElement(z.a,{dataSource:this.props.userRunSummary,loading:this.props.searchState===N.SEARCHING,rowKey:function(e){return e.username+"."+e.appId},pagination:!1,scroll:{y:"100%"},size:"small",className:"PreciseTable ScrollingFlexTable"},i.a.createElement(z.a.Column,{title:"User",dataIndex:"username",key:"username",width:"30%",render:function(e,t){return i.a.createElement(G.a,{title:e},i.a.createElement("a",{href:"#people/".concat(e),target:"_parent"},e))},sorter:function(e,t){return e.username.localeCompare(t.username)}}),i.a.createElement(z.a.Column,{title:"Module",dataIndex:"moduleId",key:"moduleId",width:"30%",render:function(e){return i.a.createElement(G.a,{title:e},i.a.createElement("a",{href:"#catalog/module/".concat(e),target:"_parent"},e))},sorter:function(e,t){return e.moduleId.localeCompare(t.moduleId)}}),i.a.createElement(z.a.Column,{title:"Function",dataIndex:"functionId",key:"functionId",width:"30%",render:function(e,t){return i.a.createElement(G.a,{title:e},i.a.createElement("a",{href:"#catalog/apps/".concat(t.appId),target:"_parent"},e))},sorter:function(e,t){return e.functionId.localeCompare(t.functionId)}}),i.a.createElement(z.a.Column,{title:"Runs",dataIndex:"runCount",key:"runCount",width:"10%",align:"right",render:function(e,t){return i.a.createElement("div",{className:"NumericColumn"},Intl.NumberFormat("en-US",{useGrouping:!0}).format(e))},sorter:function(e,t){return e.runCount-t.runCount},defaultSortOrder:"descend"}))}},{key:"render",value:function(){return i.a.createElement("div",{className:"UserRunSummary"},this.renderControlBar(),this.renderTable())}}]),t}(i.a.Component));function ct(e){return{type:r.USER_RUN_SUMMARY_SEARCH_ERROR,error:e}}var lt=Object(M.connect)((function(e,t){var n=e.views.userRunSummaryView;return{searchState:n.searchState,userRunSummary:n.userRunSummary}}),(function(e,t){return{search:function(t){e(function(e){return function(){var t=Object(ue.a)(se.a.mark((function t(n,a){var i,o,s,u,c,l,h,d,p;return se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:r.USER_RUN_SUMMARY_SEARCH_START}),i=a(),o=i.auth.userAuthorization,s=i.app.config.services.Catalog.url,o){t.next=5;break}return n(ct({message:"Not authorized",code:"unauthorized"})),t.abrupt("return");case 5:if(o){t.next=8;break}return n(ct({message:"Not authorized",code:"unauthorized"})),t.abrupt("return");case 8:return u=new ye.CatalogClient({module:"Catalog",token:o.token,url:s}),c={begin:0,end:Date.now()},t.next=12,u.getExecAggrTable(c);case 12:l=t.sent,h=l.map((function(e){var t,n,r;if(e.app){var a=e.app.split("/"),i=Object(ie.a)(a,2);n=i[0],r=i[1],t=e.app}else t=[n=e.func_mod,r=e.func].join("/");return n&&r||console.warn("bad app!",e),{username:e.user,appId:t,moduleId:n,functionId:r,runCount:e.n}})),d=e.query.split(/\s+/).map((function(e){return new RegExp(e,"i")})),p=h.filter((function(e){return d.every((function(t){return t.test(e.appId)||t.test(e.moduleId)||t.test(e.functionId)||t.test(e.username)}))})),n((f=p,{type:r.USER_RUN_SUMMARY_SEARCH_SUCCESS,userRunSummary:f}));case 17:case"end":return t.stop()}var f}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))}}}))(ut),ht=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).defaultTabKey=void 0,n.defaultTabKey="myJobs",n.state={activeTabKey:n.defaultTabKey,defaultActiveTabKey:n.defaultTabKey},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.setTitle("Job Browser")}},{key:"componentWillUnmount",value:function(){this.setState({activeTabKey:null})}},{key:"onTabsChange",value:function(e){this.setState({activeTabKey:e})}},{key:"renderJobsTab",value:function(){}},{key:"renderAdminJobsTab",value:function(){}},{key:"renderMyJobsTab",value:function(){return i.a.createElement(rt,null)}},{key:"renderUserJobsTab",value:function(){return i.a.createElement(Be,null)}},{key:"renderPublicAppStatsTab",value:function(){return i.a.createElement(st,null)}},{key:"renderUserRunSummaryTab",value:function(){return i.a.createElement(lt,null)}},{key:"renderTabs",value:function(){var e=[];if(e.push({tab:"myjobs",title:"My Jobs",component:this.renderMyJobsTab()}),this.props.isAdmin){var t=i.a.createElement("span",null,"User Jobs ",i.a.createElement(H.a,{type:"unlock"}));e.push({tab:"userjobs",title:t,component:i.a.createElement(Be,null)})}if(e.push({tab:"appstats",title:"Public AppStats",component:this.renderPublicAppStatsTab()}),this.props.isAdmin){var n=i.a.createElement("span",null,"User Run Summary ",i.a.createElement(H.a,{type:"unlock"}));e.push({tab:"userrunsummary",title:n,component:i.a.createElement(lt,null)})}return i.a.createElement(ce,{tabs:e})}},{key:"render",value:function(){return i.a.createElement("div",{className:"Col Col-scrollable"},this.renderTabs())}}]),t}(i.a.Component);var dt=Object(M.connect)((function(e,t){var n=e.views.mainView.isAdmin,r=e.app.runtime.navigation;return{isAdmin:n,view:r.view,params:r.params}}),(function(e,t){return{setTitle:function(t){e(Object(f.sendTitle)(t))},setView:function(t){e(Object(f.setView)(t))},setParams:function(t){e(Object(f.setParams)(t))}}}))(ht);function pt(e){return{type:r.MAIN_LOAD_SUCCESS,isAdmin:e}}function ft(e){return{type:r.MAIN_LOAD_ERROR,error:e}}var mt=function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderLoading",value:function(){var e=a.createElement("div",null,"Loading Main ... ",a.createElement(F.a,null));return a.createElement(J.a,{type:"info",message:e,style:{width:"20em",padding:"20px",margin:"20px auto"}})}},{key:"renderError",value:function(){if(this.props.view.error)return a.createElement(J.a,{type:"error",message:this.props.view.error.message})}},{key:"render",value:function(){switch(this.props.view.loadingState){case D.NONE:case D.LOADING:return this.renderLoading();case D.ERROR:return this.renderError();case D.SUCCESS:return a.createElement(dt,null)}}},{key:"componentDidMount",value:function(){switch(this.props.view.loadingState){case D.NONE:this.props.onLoad()}}},{key:"componentWillUnmount",value:function(){this.props.unload()}}]),t}(a.Component);var vt=Object(M.connect)((function(e,t){var n=e.auth.userAuthorization;return{view:e.views.mainView,token:n.token}}),(function(e,t){return{onLoad:function(){e(function(){var e=Object(ue.a)(se.a.mark((function e(t,n){var a,i,o,s,u;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t({type:r.MAIN_LOAD_START}),a=n(),i=a.auth.userAuthorization,o=a.app.config.services.Catalog.url,i){e.next=5;break}return t(ft({message:"Not authorized",code:"unauthorized"})),e.abrupt("return");case 5:return s=new ye.CatalogClient({token:i.token,url:o,module:"Catalog"}),e.prev=6,e.next=9,s.isAdmin();case 9:u=e.sent,t(pt(!!u)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),t(ft({message:e.t0.message,code:"error-checking-admin-status"}));case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t,n){return e.apply(this,arguments)}}())},unload:function(){e({type:r.MAIN_UNLOAD})}}}))(mt),Et=(n(1149),Object(U.d)(j,x(),Object(U.c)(Object(U.a)(P.a)))),bt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(M.Provider,{store:Et},i.a.createElement(f.AppBase,null,i.a.createElement(f.AuthGate,{required:!0},i.a.createElement(vt,null))))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(bt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},195:function(e,t,n){"use strict";var r=n(23),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i,o,s,u=n(131),c=n(345),l=n(246);function h(e,t){return{type:i.APP_LOAD_SUCCESS,config:e,runtime:t}}function d(e){return{type:i.APP_SET_TITLE,title:e}}function p(e){return{type:i.APP_NAVIGATE,navigation:e}}function f(e,t){return function(n,r){o.send(e,t)}}!function(e){e.APP_LOAD="@kbase-ui-lib/app/load",e.APP_LOAD_START="@kbase-ui-lib/app/load/start",e.APP_LOAD_SUCCESS="@kbase-ui-lib/app/load/success",e.APP_LOAD_ERROR="@kbase-ui-lib/app/load/error",e.APP_SEND_MESSAGE="@kbase-ui-lib/app/send/message",e.APP_SEND_TITLE="@kbase-ui-lib/app/send/title",e.APP_SET_TITLE="@kbase-ui-lib/app/set/title",e.APP_NAVIGATE="@kbase-ui-lib/app/navigate"}(i=t.ActionType||(t.ActionType={})),t.loadSuccess=h,t.loadError=function(e){return{type:i.APP_LOAD_ERROR,error:e}},t.sendTitle=function(e){var t=this;return function(n,i){return a(t,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=3;break}return console.warn("Trying to set title without a channel!"),t.abrupt("return");case 3:n(f("set-title",{title:e})),n(d(e));case 5:case"end":return t.stop()}}),t)})))}},t.setTitle=d,t.navigate=p,t.appStart=function(){return function(e,t){var n=c.getParamsFromDOM();if(n){var r=n.channelId;o=new u.Channel({to:r,debug:!1});o.on("start",(function(t){try{var n=t.config.services;if(e(h({baseUrl:"",services:{Groups:{url:n.Groups.url},UserProfile:{url:n.UserProfile.url},Workspace:{url:n.Workspace.url},ServiceWizard:{url:n.ServiceWizard.url},Auth:{url:n.Auth.url},NarrativeMethodStore:{url:n.NarrativeMethodStore.url},Catalog:{url:n.Catalog.url},NarrativeJobService:{url:n.NarrativeJobService.url}},defaultPath:"/"},{channelId:o.id,hostChannelId:r,devMode:!1,title:"",navigation:{view:t.view,params:t.params||{}}})),t.authorization){var a=t.authorization,i=a.token,s=a.username,u=a.realname,c=a.roles;e(l.authAuthorized(i,s,u,c))}}catch(d){o.send("start-error",{message:d.message})}o.send("started",{})}),(function(e){console.error("Error starting...",e)})),o.on("navigate",(function(t){var n=t.to,r=t.params;e(p({view:n,params:r}))}),(function(e){console.error('Error processing "navigate" message')})),o.start(),o.send("ready",{channelId:o.id,greeting:"heloooo"}),s=function(){o.send("clicked",{})},window.document.body.addEventListener("click",s)}}},t.sendMessage=f},212:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NONE=0]="NONE",e[e.CHECKING=1]="CHECKING",e[e.AUTHORIZED=2]="AUTHORIZED",e[e.UNAUTHORIZED=3]="UNAUTHORIZED",e[e.ERROR=4]="ERROR"}(r=t.AuthState||(t.AuthState={})),t.makeAuthStoreInitialState=function(){return{auth:{status:r.NONE,message:"",userAuthorization:null}}}},224:function(e,t,n){"use strict";var r=n(23),a=n(45),i=n(44),o=n(55),s=n(53),u=n(56),c=n(333),l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=h(n(323)),p=1e4,f=function(e){function t(e){var n,r=e.name,a=e.code,u=e.message,c=e.error;return i(this,t),(n=o(this,s(t).call(this,u))).name=r,n.code=a,n.error=c,n}return u(t,e),t}(c(Error));t.JSONRPCException=f;var m=function(e){function t(){return i(this,t),o(this,s(t).apply(this,arguments))}return u(t,e),t}(c(Error));t.classJSONRPCServerException=m;var v=function(){function e(t){var n=t.url,r=t.token,a=t.module,o=t.timeout;i(this,e),this.url=n,this.token=r||null,this.module=a,this.timeout=o||p}return a(e,[{key:"makePayload",value:function(e,t){return{version:"1.1",method:this.module+"."+e,id:String(Math.random()).slice(2),params:t}}},{key:"callFunc",value:function(e,t){return l(this,void 0,void 0,r.mark((function n(){var a,i,o;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={"Content-Type":"application/json",Accept:"application/json"},this.token&&(a.Authorization=this.token),i=this.makePayload(e,t),n.next=5,d.default.post(this.url,i,{headers:a,timeout:this.timeout});case 5:return o=n.sent,n.abrupt("return",o.data.result);case 7:case"end":return n.stop()}}),n,this)})))}}]),e}();t.GenericClient=v;var E=function(e){function t(e){var n;if(i(this,t),n=o(this,s(t).call(this,e)),!e.token)throw new Error("Authorized client requires token");return n.token=e.token,n}return u(t,e),a(t,[{key:"callFunc",value:function(e,t){return l(this,void 0,void 0,r.mark((function n(){var a,i,o;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=this.makePayload(e,t),i={"Content-Type":"application/json",Accept:"application/json",Authorization:this.token},n.next=4,d.default.post(this.url,a,{headers:i,timeout:this.timeout});case 4:return o=n.sent,n.abrupt("return",o.data.result);case 6:case"end":return n.stop()}}),n,this)})))}}]),t}(v);t.AuthorizedGenericClient=E},246:function(e,t,n){"use strict";var r=n(92),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i,o=a(n(344)),s=n(131);function u(){return{type:i.AUTH_CHECK_START}}function c(e){return{type:i.AUTH_CHECK_ERROR,error:e}}function l(e,t,n,r){return{type:i.AUTH_AUTHORIZED,token:e,username:t,realname:n,roles:r}}function h(){return{type:i.AUTH_UNAUTHORIZED}}!function(e){e.AUTH_CHECK="auth check",e.AUTH_CHECK_START="auth check start",e.AUTH_CHECK_ERROR="auth check error",e.AUTH_AUTHORIZED="auth authorized",e.AUTH_UNAUTHORIZED="auth unauthorized",e.AUTH_REMOVE_AUTHORIZATION="auth remove authorization",e.AUTH_ADD_AUTHORIZATION="auth add authorization",e.AUTH_ADD_AUTHORIZATION_ERROR="auth add authorization error"}(i=t.AuthActionType||(t.AuthActionType={})),t.authCheckStart=u,t.authCheckError=c,t.authAuthorized=l,t.authUnauthorized=h,t.checkAuth=function(){return function(e,t){e(u());var n=t().app.config.services.Auth.url,a=o.get("kbase_session");if(a){var i=new s.AuthClient({url:n});Promise.all([i.getTokenInfo(a),i.getMe(a)]).then((function(t){var n=r(t,2),i=(n[0],n[1]),o=i.roles.map((function(e){var t=e.id;e.desc;return t}));e(l(a,i.user,i.display,o))})).catch((function(t){console.error("auth check error",t),e(c({code:"error",message:t.message}))}))}else e(h())}},t.removeAuthorization=function(){return function(e,t){o.remove("kbase_session"),e(h())}},t.addAuthorization=function(e){return function(t,n){var a=n().app.config.services.Auth.url;o.set("kbase_session",e);var i=new s.AuthClient({url:a});Promise.all([i.getTokenInfo(e),i.getMe(e)]).then((function(n){var a=r(n,2),i=(a[0],a[1]),o=i.roles.map((function(e){var t=e.id;e.desc;return t}));t(l(e,i.user,i.display,o))})).catch((function(e){console.error("auth check error",e),t(c({code:"error",message:e.message}))}))}}},247:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.READY=2]="READY",e[e.ERROR=3]="ERROR"}(r=t.AppState||(t.AppState={})),t.makeIntegrationStoreInitialState=function(){return{app:{status:r.NONE,config:{baseUrl:"",services:{Groups:{url:""},UserProfile:{url:""},Workspace:{url:""},ServiceWizard:{url:""},Auth:{url:""},NarrativeMethodStore:{url:""},Catalog:{url:""},NarrativeJobService:{url:""}},defaultPath:""},runtime:{channelId:null,hostChannelId:null,devMode:null,title:"",navigation:{view:"",params:{}}}}}}},248:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NONE=0]="NONE",e[e.HOSTED=1]="HOSTED",e[e.DEVELOP=2]="DEVELOP",e[e.ERROR=3]="ERROR"}(r=t.RootState||(t.RootState={})),t.makeRootStoreInitialState=function(){return{root:{hostChannelId:null,state:r.NONE}}}},28:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(525);t.AppBase=r.default;var a=n(346);t.Loader=a.default;var i=n(895);t.makeBaseStoreState=i.makeBaseStoreState;var o=n(896);t.NiceTimeDuration=o.default;var s=n(897);t.NiceRelativeTime=s.default;var u=n(898);t.NiceElapsedTime=u.default;var c=n(195);t.sendTitle=c.sendTitle,t.setTitle=c.setTitle,t.navigate=c.navigate;var l=n(899);t.AuthGate=l.default;var h=n(294);t.setView=h.setView,t.setParams=h.setParams;var d=n(902);t.baseReducer=d.default},293:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.NONE="developStatus/none",e.LOADING="developStatus/loading",e.READY="developStatus/ready",e.ERROR="developStatus/error"}(r=t.DevelopStatus||(t.DevelopStatus={})),t.makeDevelopStore=function(){return{develop:{title:"SET TITLE HERE",status:r.NONE,view:"",params:{}}}}},294:function(e,t,n){"use strict";var r=n(23),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i,o,s=n(131),u=n(131);function c(e){return{type:i.DEVELOP_SET_TITLE,title:e}}function l(e){return{type:i.DEVELOP_LOAD_SUCCESS,hostChannelId:e}}!function(e){e.DEVELOP_SET_TITLE="develop/set/title",e.DEVELOP_START="develop/start",e.DEVELOP_LOAD_SUCCESS="develop/load/success",e.DEVELOP_SET_VIEW="develop/set/view",e.DEVELOP_SET_PARAMS="develop/set/params"}(i=t.DevelopActionType||(t.DevelopActionType={})),t.setTitle=c,t.loadSuccess=l,t.setView=function(e){return{type:i.DEVELOP_SET_VIEW,view:e}},t.setParams=function(e){return{type:i.DEVELOP_SET_PARAMS,params:e}};var h={baseUrl:"",defaultPath:"",services:{Groups:{url:"/services/groups"},UserProfile:{url:"/services/user_profile/rpc"},Workspace:{url:"/services/ws"},ServiceWizard:{url:"/services/service_wizard"},Auth:{url:"/services/auth"},NarrativeMethodStore:{url:"/services/narrative_method_store/rpc"},Catalog:{url:"/services/catalog/rpc"},NarrativeJobService:{url:"/services/njs_wrapper"}}};function d(e,t){var n=this;e.on("ready",(function(t){return a(n,void 0,void 0,r.mark((function n(){var a,i;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.setPartner(t.channelId),a=new u.Auth(h.services.Auth.url),n.next=4,a.checkAuth();case 4:(i=n.sent).status===u.AuthState.AUTHENTICATED?e.send("start",{authorization:{token:i.userAuthorization.token,username:i.userAuthorization.username,realname:i.userAuthorization.realname,roles:i.userAuthorization.roles},config:h,view:"",params:{}}):e.send("start",{authorization:null,config:h});case 6:case"end":return n.stop()}}),n)})))})),e.on("get-auth-status",(function(){return a(n,void 0,void 0,r.mark((function t(){var n,a;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new u.Auth(h.services.Auth.url),t.next=3,n.checkAuth();case 3:(a=t.sent).status===u.AuthState.AUTHENTICATED?e.send("auth-status",{token:a.userAuthorization.token,username:a.userAuthorization.username,realname:a.userAuthorization.realname,roles:a.userAuthorization.roles}):e.send("auth-status",{token:null,username:"",realname:"",roles:[]});case 5:case"end":return t.stop()}}),t)})))})),e.on("get-config",(function(){e.send("config",{value:h})})),e.on("add-button",(function(e){e.button;console.warn("add button not yet supported")})),e.on("open-window",(function(e){var t=e.url;window.location.href=t})),e.on("ui-navigate",(function(e){console.warn("ui-navigate not yet supported")})),e.on("post-form",(function(e){console.warn("form-post not yet supported")})),e.on("set-title",(function(e){t(c(e.title))})),e.start()}t.start=function(e){var t=this;return function(e,n){return a(t,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:d(o=new s.Channel({debug:!1}),e),e(l(o.id));case 3:case"end":return t.stop()}}),t)})))}}},345:function(e,t,n){"use strict";function r(){return window.frameElement?window.frameElement||null:window.document.querySelector('[data-plugin-host="true"]')}Object.defineProperty(t,"__esModule",{value:!0}),t.getParamsFromIFrame=function(){var e=r();if(!e)return null;if(!e.hasAttribute("data-params"))return null;var t=e.getAttribute("data-params");return null===t?null:JSON.parse(decodeURIComponent(t))},t.getParamsFromDOM=function(){var e=r();if(!e)return null;if(!e.hasAttribute("data-params"))return null;var t=e.getAttribute("data-params");return null===t?null:JSON.parse(decodeURIComponent(t))},t.getChannelID=function(){var e=r();return e&&e.hasAttribute("data-channel")?e.getAttribute("data-channel"):null}},346:function(e,t,n){"use strict";var r=n(44),a=n(45),i=n(55),o=n(53),s=n(56),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(0)),l=n(247),h=function(e){function t(){return r(this,t),i(this,o(t).apply(this,arguments))}return s(t,e),a(t,[{key:"componentDidMount",value:function(){this.props.onLoad()}},{key:"renderError",value:function(){return this.props.error?c.createElement("div",{"data-k-b-testhook-component":"Loader","data-k-b-testhook-element":"error"},this.props.error.message):c.createElement("div",{"data-k-b-testhook-component":"Loader","data-k-b-testhook-element":"error"},"An Unknown Error Occurred!")}},{key:"renderLoading",value:function(){return c.createElement("div",{"data-k-b-testhook-component":"Loader","data-k-b-testhook-element":"loading"},"Loading...")}},{key:"render",value:function(){switch(this.props.status){case l.AppState.NONE:case l.AppState.LOADING:return this.renderLoading();case l.AppState.ERROR:return this.renderError();case l.AppState.READY:return this.props.children}}}]),t}(c.Component);t.default=h},425:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ROOT_START_HOSTED_ENVIRONMENT=0]="ROOT_START_HOSTED_ENVIRONMENT",e[e.ROOT_START_DEVELOPMENT_ENVIRONMENT=1]="ROOT_START_DEVELOPMENT_ENVIRONMENT"}(r=t.RootActionType||(t.RootActionType={})),t.startHostedEnvironment=function(e){return{type:r.ROOT_START_HOSTED_ENVIRONMENT,params:e}},t.startDevelopmentEnvironment=function(){return{type:r.ROOT_START_DEVELOPMENT_ENVIRONMENT}}},470:function(e,t,n){"use strict";var r=n(55),a=n(53),i=n(56),o=n(44),s=n(45),u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(323)),l=function(){function e(t){var n=t.url,r=t.token,a=t.timeout;o(this,e),this.url=n,this.token=r||null,this.timeout=a}return s(e,[{key:"makePayload",value:function(e,t){return{version:"1.1",method:this.constructor.module+"."+e,id:String(Math.random()).slice(2),params:[t]}}},{key:"makeEmptyPayload",value:function(e){return{version:"1.1",method:this.constructor.module+"."+e,id:String(Math.random()).slice(2),params:[]}}}]),e}();t.ServiceClient=l;var h=function(e){function t(e){var n;if(o(this,t),n=r(this,a(t).call(this,e)),!e.token)throw new Error("Authorized client requires token");return n.token=e.token,n}return i(t,e),s(t,[{key:"callFunc",value:function(e,t){var n=this;return new Promise((function(r,a){c.default.post(n.url,n.makePayload(e,t),{headers:{Authorization:n.token,"Content-Type":"application/json",Accept:"application/json"},timeout:n.timeout}).then((function(e){r(e.data)})).catch((function(e){a(e)}))}))}}]),t}(l);t.AuthorizedServiceClient=h},471:function(e,t,n){"use strict";var r=n(23),a=n(44),i=n(45),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(323)),c="",l="api/V2/token",h="api/V2/me",d=function(){function e(t){var n=t.url;a(this,e),this.url=n}return i(e,[{key:"makePath",value:function(e){return"string"===typeof e?[this.url].concat([e]).join("/"):[this.url].concat(e).join("/")}},{key:"root",value:function(){return o(this,void 0,void 0,r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.default.get(this.makePath([c]),{headers:{Accept:"application/json"}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getTokenInfo",value:function(e){return o(this,void 0,void 0,r.mark((function t(){var n,a;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.default.get(this.makePath([l]),{headers:{Accept:"application/json",Authorization:e}});case 2:return n=t.sent,a=n.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"getMe",value:function(e){return o(this,void 0,void 0,r.mark((function t(){var n,a;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.default.get(this.makePath([h]),{headers:{Accept:"application/json",Authorization:e}});case 2:return n=t.sent,a=n.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t,this)})))}}]),e}();t.default=d},519:function(e,t,n){e.exports=n(1150)},524:function(e,t,n){},525:function(e,t,n){"use strict";var r=n(44),a=n(45),i=n(55),o=n(53),s=n(56),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=u(n(0));n(528),n(529),n(530),n(531),n(532);var h=c(n(533)),d=c(n(573)),p=function(e){function t(e){var n;return r(this,t),(n=i(this,o(t).call(this,e))).hosted=!!window.frameElement,n.state={clicks:0},n}return s(t,e),a(t,[{key:"clickMe",value:function(){this.setState({clicks:this.state.clicks+1})}},{key:"render",value:function(){return l.createElement(d.default,null,l.createElement(h.default,null,l.createElement("div",{className:"Row Row-fullheight Row-scrollable","data-k-b-testhook-component":"AppBase"},l.createElement("div",{className:"Col scrollable"},this.props.children))))}}]),t}(l.Component);t.default=p},528:function(e,t,n){},531:function(e,t,n){},532:function(e,t,n){},533:function(e,t,n){"use strict";var r=n(44),a=n(45),i=n(55),o=n(53),s=n(56),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=u(n(0)),h=n(62),d=n(195),p=c(n(346)),f=c(n(570)),m=function(e){function t(){return r(this,t),i(this,o(t).apply(this,arguments))}return s(t,e),a(t,[{key:"render",value:function(){return l.createElement(p.default,{status:this.props.status,error:this.props.error,onLoad:this.props.onLoad},l.createElement(f.default,null,this.props.children))}}]),t}(l.Component);function v(e,t){return{status:e.app.status}}function E(e){return{onLoad:function(){e(d.appStart())}}}t.mapStateToProps=v,t.mapDispatchToProps=E,t.default=h.connect(v,E)(m)},570:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(62),i=n(195),o=r(n(571));function s(e,t){var n=e.app,r=(n.status,n.config.defaultPath),a=n.runtime.title;return{defaultPath:r,hostChannelId:e.root.hostChannelId,title:a}}function u(e){return{onAppStart:function(){e(i.appStart())}}}t.mapStateToProps=s,t.mapDispatchToProps=u,t.default=a.connect(s,u)(o.default)},571:function(e,t,n){"use strict";var r=n(44),a=n(45),i=n(55),o=n(53),s=n(56),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(0));n(572);var l=function(e){function t(e){var n;return r(this,t),(n=i(this,o(t).call(this,e))).state={ready:!1},n.hosted=!!window.frameElement,n.channel=null,n}return s(t,e),a(t,[{key:"teardownChannel",value:function(){}},{key:"componentDidMount",value:function(){this.setState({ready:!0})}},{key:"componentWillUnmount",value:function(){this.teardownChannel()}},{key:"renderReady",value:function(){return c.createElement(c.Fragment,null,this.props.children)}},{key:"renderNotReady",value:function(){return c.createElement("div",{"data-k-b-testhook-element":"notready"},"Loading...")}},{key:"render",value:function(){return c.createElement("div",{"data-k-b-testhook-component":"KBaseIntegration",className:"scrollable-flex-column"},this.state.ready?this.renderReady():this.renderNotReady())}}]),t}(c.Component);t.default=l},572:function(e,t,n){},573:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(62),i=r(n(574)),o=n(425);function s(e,t){return{rootState:e.root.state}}function u(e){return{startHostedEnvironment:function(t){e(o.startHostedEnvironment(t))},startDevelopmentEnvironment:function(){e(o.startDevelopmentEnvironment())}}}t.mapStateToProps=s,t.mapDispatchToProps=u,t.default=a.connect(s,u)(i.default)},574:function(e,t,n){"use strict";var r=n(44),a=n(45),i=n(55),o=n(53),s=n(56),u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(0)),l=n(345),h=n(248),d=u(n(575));var p=function(e){function t(e){var n;return r(this,t),(n=i(this,o(t).call(this,e))).iframeParams=l.getParamsFromIFrame(),n}return s(t,e),a(t,[{key:"componentDidMount",value:function(){this.iframeParams?this.props.startHostedEnvironment(this.iframeParams):this.props.startDevelopmentEnvironment()}},{key:"renderDebug",value:function(){var e=function(e){switch(e){case h.RootState.NONE:return"none";case h.RootState.HOSTED:return"hosted";case h.RootState.DEVELOP:return"develop";case h.RootState.ERROR:return"error"}}(this.props.rootState);return c.default.createElement("div",null,"Root State: ",e,", ")}},{key:"render",value:function(){switch(this.props.rootState){case h.RootState.NONE:return c.default.createElement("div",null,"Loading...");case h.RootState.HOSTED:return c.default.createElement(c.default.Fragment,null,this.props.children);case h.RootState.DEVELOP:return c.default.createElement(d.default,null,this.props.children);case h.RootState.ERROR:return c.default.createElement("div",null,"Error!")}}}]),t}(c.default.Component);t.default=p},575:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(62),i=r(n(576)),o=n(294),s=n(246);function u(e,t){var n=e.root.hostChannelId,r=e.develop,a=r.title,i=r.status;return{title:a,hostChannelId:n,authorization:e.auth,developStatus:i}}function c(e){return{start:function(t){e(o.start(t))},addAuthorization:function(t){e(s.addAuthorization(t))},removeAuthorization:function(){e(s.removeAuthorization())}}}t.mapStateToProps=u,t.mapDispatchToProps=c,t.default=a.connect(u,c)(i.default)},576:function(e,t,n){"use strict";var r=n(44),a=n(45),i=n(55),o=n(53),s=n(56),u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(0));n(577);var l=n(189),h=n(212),d=n(293);var p=function(e){function t(e){var n;return r(this,t),(n=i(this,o(t).call(this,e))).tokenRef=c.default.createRef(),n}return s(t,e),a(t,[{key:"componentDidMount",value:function(){this.props.start(window)}},{key:"onLoginClick",value:function(){if(null!==this.tokenRef.current){var e=this.tokenRef.current.value;0!==e.length&&this.props.addAuthorization(e)}}},{key:"onLogoutClick",value:function(){this.props.removeAuthorization()}},{key:"renderAuthForm",value:function(){return c.default.createElement("div",{className:"Develop-auth-form"},c.default.createElement("p",null,c.default.createElement("b",null,"Not Authenticated!")," Enter a Login Token below."),"Token: ",c.default.createElement("input",{ref:this.tokenRef,style:{width:"30em"}}),c.default.createElement(l.Button,{icon:"login",htmlType:"submit",onClick:this.onLoginClick.bind(this)},"Login"))}},{key:"renderAuthToolbar",value:function(){if(this.props.authorization.userAuthorization)return c.default.createElement("div",{className:"Develop-auth-toolbar"},"Logged in as"," ",c.default.createElement("b",null,c.default.createElement("span",null,this.props.authorization.userAuthorization.realname)," (",c.default.createElement("span",null,this.props.authorization.userAuthorization.username)),")"," ",c.default.createElement(l.Button,{icon:"logout",onClick:this.onLogoutClick.bind(this)},"Logout"))}},{key:"renderAuth",value:function(){switch(this.props.authorization.status){case h.AuthState.CHECKING:return c.default.createElement("div",null);case h.AuthState.AUTHORIZED:return c.default.createElement("div",{className:"Auth Auth-authorized scrollable-flex-column"},this.renderAuthToolbar());case h.AuthState.NONE:case h.AuthState.UNAUTHORIZED:return c.default.createElement("div",{className:"Auth Auth-unauthorized scrollable-flex-column"},this.renderAuthForm());case h.AuthState.ERROR:return c.default.createElement("div",{className:"Auth Auth-unauthorized scrollable-flex-column"},c.default.createElement("p",null,"Error"),this.props.authorization.message);default:return c.default.createElement("div",null)}}},{key:"renderDevError",value:function(){return c.default.createElement("div",null,"Dev Error")}},{key:"renderDevReady",value:function(){var e={channelId:this.props.hostChannelId},t=JSON.stringify(e);return c.default.createElement("div",{"data-params":encodeURIComponent(t),"data-plugin-host":"true",className:"Develop"},c.default.createElement("div",{className:"Develop-area"},c.default.createElement(l.Tag,null,"Develop Mode Area"),this.renderTitleToolbar(),this.renderAuth()),this.props.children)}},{key:"renderDevLoading",value:function(){var e=c.default.createElement("div",{className:"Develop-area"},c.default.createElement(l.Spin,null)," Loading Dev Environment...");return c.default.createElement(l.Alert,{message:e})}},{key:"renderDev",value:function(){switch(this.props.developStatus){case d.DevelopStatus.NONE:case d.DevelopStatus.LOADING:return this.renderDevLoading();case d.DevelopStatus.ERROR:return this.renderDevError();case d.DevelopStatus.READY:return this.renderDevReady()}}},{key:"renderTitleToolbar",value:function(){return c.default.createElement("div",{className:"Develop-toolbar"},"Title: ",c.default.createElement("span",null,this.props.title))}},{key:"renderDebug",value:function(){return c.default.createElement("div",{className:"Develop-debug"},"Development: dev status: ",this.props.developStatus,", channel:",this.props.hostChannelId)}},{key:"render",value:function(){return c.default.createElement(c.default.Fragment,null,this.renderDev())}}]),t}(c.default.Component);t.default=p},577:function(e,t,n){},77:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1083);t.Channel=r.Channel;var a=n(224);t.GenericClient=a.GenericClient,t.AuthorizedGenericClient=a.AuthorizedGenericClient;var i=n(470);t.ServiceClient=i.ServiceClient,t.AuthorizedServiceClient=i.AuthorizedServiceClient;var o=n(1103);t.DynamicServiceClient=o.DynamicServiceClient;var s=n(1105);t.NarrativeJobServiceClient=s.default;var u=n(1106);t.CatalogClient=u.default;var c=n(471);t.AuthClient=c.default;var l=n(1107);t.niceDuration=l.niceDuration,t.niceElapsed=l.niceElapsed,t.niceRelativeTime=l.niceRelativeTime;var h=n(1108);t.Auth=h.default,t.AuthState=h.AuthState},895:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(247),a=n(212),i=n(293),o=n(248);t.makeBaseStoreState=function(){var e=o.makeRootStoreInitialState(),t=r.makeIntegrationStoreInitialState(),n=a.makeAuthStoreInitialState(),s=i.makeDevelopStore();return Object.assign({},e,t,n,s)}},896:function(e,t,n){"use strict";var r=n(44),a=n(45),i=n(55),o=n(53),s=n(56),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(0)),l=n(189),h=n(131),d=function(e){function t(){return r(this,t),i(this,o(t).apply(this,arguments))}return s(t,e),a(t,[{key:"render",value:function(){if(!1===this.props.showTooltip)return c.createElement("span",null,h.niceDuration(this.props.duration,{}));var e,t=c.createElement("span",null,h.niceDuration(this.props.duration,{}));return e=this.props.tooltipPrefix?c.createElement("span",null,this.props.tooltipPrefix,t):t,c.createElement(l.Tooltip,{placement:"bottomRight",title:e},h.niceDuration(this.props.duration,{precision:this.props.precision}))}}]),t}(c.Component);t.default=d},897:function(e,t,n){"use strict";var r=n(92),a=n(44),i=n(45),o=n(55),s=n(53),u=n(56),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var l=c(n(0)),h=n(131),d=n(189),p=[[6e4,500],[36e5,3e4],[864e5,18e5],[1/0,864e5]],f=function(e){function t(e){var n;return a(this,t),(n=o(this,s(t).call(this,e))).nowTimer=null,n.state={now:new Date},n.interval=n.calcInterval(),n}return u(t,e),i(t,[{key:"calcInterval",value:function(){var e=this.state.now.getTime()-this.props.time.getTime(),t=!0,n=!1,a=void 0;try{for(var i,o=p[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value,u=r(s,2),c=u[0],l=u[1];if(e<c)return l}}catch(h){n=!0,a=h}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}throw console.error("hmm again",e,p),new Error("did not find interval")}},{key:"handleInterval",value:function(){this.setState({now:new Date});var e=this.calcInterval();this.interval!==e&&(this.interval=e,this.startIntervalTimer())}},{key:"startIntervalTimer",value:function(){var e=this;this.nowTimer&&window.clearInterval(this.nowTimer),this.nowTimer=window.setInterval((function(){e.handleInterval()}),this.interval)}},{key:"componentDidMount",value:function(){this.startIntervalTimer()}},{key:"componentWillUnmount",value:function(){this.nowTimer&&window.clearInterval(this.nowTimer)}},{key:"render",value:function(){if(!1===this.props.showTooltip)return l.createElement("span",null,h.niceRelativeTime(this.props.time,{absoluteAfter:30,now:this.state.now}));var e,t=l.createElement("span",null,Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"}).format(this.props.time));return e=this.props.tooltipPrefix?l.createElement("span",null,this.props.tooltipPrefix,t):t,l.createElement(d.Tooltip,{placement:"bottomRight",title:e},h.niceRelativeTime(this.props.time,{absoluteAfter:30,now:this.state.now}))}}]),t}(l.Component);t.default=f},898:function(e,t,n){"use strict";var r=n(92),a=n(44),i=n(45),o=n(55),s=n(53),u=n(56),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var l=c(n(0)),h=n(189),d=n(131),p=function(e){function t(e){var n;return a(this,t),(n=o(this,s(t).call(this,e))).clockTimer=null,n.state={clockTime:Date.now()},n}return u(t,e),i(t,[{key:"startClock",value:function(){var e=this;this.clockTimer=window.setInterval((function(){e.setState({clockTime:Date.now()})}),250)}},{key:"componentDidMount",value:function(){!this.props.to&&this.props.useClock&&this.startClock()}},{key:"componentWillUnmount",value:function(){this.clockTimer&&window.clearInterval(this.clockTimer)}},{key:"render",value:function(){var e;e=this.props.to?this.props.to-this.props.from:this.state.clockTime-this.props.from;var t,n=d.niceElapsed(e,{}),a=r(n,1)[0];if(!1===this.props.showTooltip)return l.createElement("span",null,a);t=this.props.tooltipPrefix?l.createElement("span",null,this.props.tooltipPrefix,l.createElement("span",null,a)):l.createElement("span",null,a);var i=d.niceElapsed(e,{precision:this.props.precision}),o=r(i,2),s=o[0];o[1];return l.createElement(h.Tooltip,{placement:"bottomRight",title:t},s)}}]),t}(l.Component);t.default=p},899:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(62),i=r(n(900)),o=n(212);t.default=a.connect((function(e,t){var n,r=e.auth,a=r.status,i=r.userAuthorization,s=!1;switch(a){case o.AuthState.NONE:case o.AuthState.CHECKING:n=null;break;case o.AuthState.AUTHORIZED:n=i.token,s=!0;break;case o.AuthState.UNAUTHORIZED:case o.AuthState.ERROR:n=null;break;default:n=null}return{token:n,authState:a,isAuthorized:s}}),(function(e,t){return{}}))(i.default)},900:function(e,t,n){"use strict";var r=n(44),a=n(45),i=n(55),o=n(53),s=n(56),u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(0));n(901);var l=n(189),h=function(e){function t(e){var n;return r(this,t),(n=i(this,o(t).call(this,e))).required=e.required,n}return s(t,e),a(t,[{key:"renderUnauthorized",value:function(){return c.default.createElement(l.Alert,{type:"error",message:"Not authorized - authentication required",style:{width:"70%",margin:"auto"}})}},{key:"render",value:function(){return this.props.isAuthorized?c.default.createElement(c.default.Fragment,null,this.props.children):this.renderUnauthorized()}}]),t}(c.default.Component);t.default=h},901:function(e,t,n){},902:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(903)),i=r(n(904)),o=r(n(905)),s=r(n(906));t.default=function(e,t){for(var n=0,r=[s.default,a.default,i.default,o.default];n<r.length;n++){var u=(0,r[n])(e,t);if(u)return u}}},903:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(247),a=n(195);t.default=function(e,t){if(!e)return e;switch(t.type){case a.ActionType.APP_LOAD_SUCCESS:return function(e,t){return Object.assign({},e,{app:{status:r.AppState.READY,config:t.config,runtime:t.runtime}})}(e,t);case a.ActionType.APP_SET_TITLE:return function(e,t){return Object.assign({},e,{app:Object.assign({},e.app,{runtime:Object.assign({},e.app.runtime,{title:t.title})}),develop:Object.assign({},e.develop,{title:t.title})})}(e,t);case a.ActionType.APP_NAVIGATE:return function(e,t){return Object.assign({},e,{app:Object.assign({},e.app,{runtime:Object.assign({},e.app.runtime,{navigation:t.navigation})})})}(e,t);default:return}}},904:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(212),a=n(246);function i(e,t){return Object.assign({},e,{auth:{status:r.AuthState.CHECKING,message:"",userAuthorization:{token:"",username:"",realname:"",roles:[]}}})}function o(e,t){return Object.assign({},e,{auth:{status:r.AuthState.ERROR,message:t.error.message,userAuthorization:{token:"",username:"",realname:"",roles:[]}}})}function s(e,t){return Object.assign({},e,{auth:{status:r.AuthState.AUTHORIZED,message:"",userAuthorization:{token:t.token,username:t.username,realname:t.realname,roles:t.roles}}})}function u(e,t){return Object.assign({},e,{auth:{status:r.AuthState.UNAUTHORIZED,message:"",userAuthorization:{token:"",username:"",realname:"",roles:[]}}})}t.authCheckStart=i,t.authCheckError=o,t.authAuthorized=s,t.authUnauthorized=u;t.default=function(e,t){if(!e)return e;switch(t.type){case a.AuthActionType.AUTH_CHECK_START:return i(e);case a.AuthActionType.AUTH_AUTHORIZED:return s(e,t);case a.AuthActionType.AUTH_UNAUTHORIZED:return u(e);case a.AuthActionType.AUTH_CHECK_ERROR:return o(e,t);default:return}}},905:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(293),a=n(294);t.default=function(e,t){if(!e)return e;switch(t.type){case a.DevelopActionType.DEVELOP_SET_TITLE:return function(e,t){return Object.assign({},e,{develop:Object.assign({},e.develop,{title:t.title})})}(e,t);case a.DevelopActionType.DEVELOP_LOAD_SUCCESS:return function(e,t){return Object.assign({},e,{root:Object.assign({},e.root,{hostChannelId:t.hostChannelId}),develop:Object.assign({},e.develop,{status:r.DevelopStatus.READY})})}(e,t);case a.DevelopActionType.DEVELOP_SET_VIEW:return function(e,t){return Object.assign({},e,{app:Object.assign({},e.app,{runtime:Object.assign({},e.app.runtime,{navigation:Object.assign({},e.app.runtime.navigation,{view:t.view})})}),develop:Object.assign({},e.develop,{view:t.view})})}(e,t);case a.DevelopActionType.DEVELOP_SET_PARAMS:return function(e,t){return Object.assign({},e,{app:Object.assign({},e.app,{runtime:Object.assign({},e.app.runtime,{navigation:Object.assign({},e.app.runtime.navigation,{params:t.params})})}),develop:Object.assign({},e.develop,{params:t.params})})}(e,t);default:return}}},906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(248),a=n(425);t.default=function(e,t){if(!e)return e;switch(t.type){case a.RootActionType.ROOT_START_HOSTED_ENVIRONMENT:return function(e,t){return Object.assign({},e,{root:Object.assign({},e.root,{state:r.RootState.HOSTED,hostChannelId:t.params.channelId})})}(e,t);case a.RootActionType.ROOT_START_DEVELOPMENT_ENVIRONMENT:return function(e,t){return Object.assign({},e,{root:Object.assign({},e.root,{state:r.RootState.DEVELOP,hostChannelId:null})})}(e);default:return}}},910:function(e,t,n){},971:function(e,t,n){},974:function(e,t,n){}},[[519,1,2]]]);
//# sourceMappingURL=main.7fff7820.chunk.js.map